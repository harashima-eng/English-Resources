<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>15 接続詞 | Conjunctions (Teal Theme)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600&family=Noto+Serif+JP:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Core palette - Nordic warm kinari */
      --bg: #F5F0E6;
      --bg-warm: #EDE8DE;
      --card: #FFFFFF;
      --text: #1C1917;
      --text-secondary: #57534E;
      --text-muted: #A3A09C;
      --accent: #E85D3B;
      --border: rgba(28, 25, 23, 0.08);
      --border-visible: rgba(28, 25, 23, 0.12);
      /* Enhanced Nordic shadows with soft inset glow */
      --shadow-sm: 0 1px 2px rgba(61, 67, 64, 0.05),
                   0 4px 12px rgba(61, 67, 64, 0.08),
                   inset 0 1px 0 rgba(255, 255, 255, 0.5);
      --shadow: 0 2px 4px rgba(61, 67, 64, 0.06),
                0 8px 24px rgba(61, 67, 64, 0.12),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
      --shadow-lg: 0 4px 8px rgba(61, 67, 64, 0.06),
                   0 16px 48px rgba(61, 67, 64, 0.15),
                   inset 0 2px 0 rgba(255, 255, 255, 0.7);
      --radius: 20px;
      --radius-sm: 12px;
      /* Fluid typography */
      --fs-qtext: clamp(17px, 1.3vw, 19px);
      --fs-base: clamp(15px, 1.1vw, 17px);

      /* Category Colors - distinctive and memorable */
      --cat-basic: #5A8F65;
      --cat-basic-light: #EDF5EF;
      --cat-comm: #C28A2E;
      --cat-comm-light: #FBF6ED;
      --cat-advanced: #7E5A9E;
      --cat-advanced-light: #F5F0F8;

      /* Conjunction type colors - NORDIC TEAL THEME */
      --coord: #0D9488;         /* Teal (Primary accent) */
      --coord-light: #f0fdfa;   /* Very light teal tint */
      --subord: #5B7A82;        /* Nordic Slate - muted teal-gray */
      --subord-light: #f5f7f8;  /* Almost white, hint of cool */
      --correl: #7D8B75;        /* Nordic Moss - muted gray-green */
      --correl-light: #f6f7f5;  /* Almost white, hint of green */
      --adverb: #8B8178;        /* Nordic Stone - warm gray/beige */
      --adverb-light: #f8f7f6;  /* Almost white, hint of warm */
    }

    [data-theme="dark"] {
      /* Gradient glassy background - gray-beige with depth */
      --bg: #141312;
      --bg-warm: #1e1c1a;
      --card: rgba(36, 34, 32, 0.92);
      --card-solid: #242220;
      --text: #F5F3F0;
      --text-secondary: #A3A09C;
      --text-muted: #666666;
      --accent: #F06A48;
      --border: rgba(255, 255, 255, 0.06);
      --border-visible: rgba(255, 255, 255, 0.10);
      /* Enhanced dark mode shadows - more visible on dark backgrounds */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.35),
                   0 0 0 1px rgba(255, 255, 255, 0.03),
                   inset 0 1px 0 rgba(255, 255, 255, 0.05);
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.06);
      --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.6),
                   0 0 0 1px rgba(255, 255, 255, 0.05),
                   inset 0 1px 0 rgba(255, 255, 255, 0.08);

      --cat-basic: #6BA876;
      --cat-basic-light: rgba(90, 143, 101, 0.15);
      --cat-comm: #D9A043;
      --cat-comm-light: rgba(194, 138, 46, 0.15);
      --cat-advanced: #9A72B8;
      --cat-advanced-light: rgba(126, 90, 158, 0.15);

      --coord: #5BA8A0;         /* Muted teal for dark bg */
      --coord-light: rgba(91, 168, 160, 0.12);
      --subord: #7A9AA3;        /* Muted slate for dark bg */
      --subord-light: rgba(122, 154, 163, 0.12);
      --correl: #95A58D;        /* Muted moss for dark bg */
      --correl-light: rgba(149, 165, 141, 0.12);
      --adverb: #A39B93;        /* Muted stone for dark bg */
      --adverb-light: rgba(163, 155, 147, 0.12);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', 'Noto Sans JP', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }

    /* Dark mode gradient glassy background */
    [data-theme="dark"] body {
      background: var(--bg);
      background-image:
        radial-gradient(ellipse 100% 80% at 50% 0%, rgba(91, 168, 160, 0.06) 0%, transparent 50%),
        radial-gradient(ellipse 80% 60% at 20% 100%, rgba(139, 129, 120, 0.05) 0%, transparent 40%),
        radial-gradient(ellipse 60% 50% at 80% 80%, rgba(122, 154, 163, 0.04) 0%, transparent 40%),
        linear-gradient(135deg, #141312 0%, #1a1816 50%, #121110 100%);
      background-attachment: fixed;
    }

    /* ===== TOP NAVIGATION BAR - Auto-Hide with Glassmorphism ===== */
    .top-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      padding: 0 24px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      /* Auto-hide: slide up when hidden */
      transform: translateY(-100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      /* Glassmorphism effect */
      background: rgba(250, 248, 245, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(28, 25, 23, 0.08);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
    }

    .top-nav.visible {
      transform: translateY(0);
    }

    [data-theme="dark"] .top-nav {
      background: rgba(15, 14, 13, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
    }

    .top-nav-logo {
      font-family: 'New York', 'Georgia', serif;
      font-size: 15px;
      font-weight: 400;
      letter-spacing: 0.02em;
      color: var(--text-secondary);
    }

    .top-nav-center {
      display: flex;
      gap: 4px;
      background: var(--bg-warm);
      padding: 4px;
      border-radius: 100px;
    }

    .top-nav-link {
      padding: 10px 24px;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      text-decoration: none;
      border-radius: 100px;
      transition: color 0.2s ease, background-color 0.2s ease, transform 0.15s ease;
      cursor: pointer;
      border: none;
      background: transparent;
      font-family: inherit;
    }

    .top-nav-link:hover {
      color: var(--text);
      transform: translateY(-1px);
    }

    .top-nav-link.active {
      color: var(--text);
      background: var(--card);
      box-shadow: var(--shadow-sm);
    }

    .top-nav-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .view-toggle-nav {
      display: flex;
      background: var(--bg-warm);
      border-radius: 100px;
      padding: 4px;
    }

    .view-btn-nav {
      padding: 8px 16px;
      border: none;
      border-radius: 100px;
      background: transparent;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
    }

    .view-btn-nav.active {
      background: var(--card);
      color: var(--text);
      box-shadow: var(--shadow-sm);
    }

    .top-nav-theme {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--card);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .top-nav-theme:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-sm);
    }

    /* ===== SUB NAVIGATION - Auto-Hide with Glassmorphism ===== */
    .sub-nav {
      position: fixed;
      top: 60px;
      left: 0;
      right: 0;
      z-index: 999;
      padding: 12px 24px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      /* Auto-hide: slide up when hidden */
      transform: translateY(-100%);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                  opacity 0.3s ease;
      /* Glassmorphism effect */
      background: rgba(250, 248, 245, 0.9);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(28, 25, 23, 0.08);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
    }

    .sub-nav.visible {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }

    [data-theme="dark"] .sub-nav {
      background: rgba(15, 14, 13, 0.9);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .sub-nav-categories {
      display: flex;
      gap: 8px;
    }

    .sub-nav-cat {
      padding: 10px 24px;
      border: 2px solid var(--border);
      border-radius: 100px;
      background: transparent;
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      /* Simplified: reduced from 5 properties to 3 essential ones for better performance */
      /* 簡略化: パフォーマンス向上のため5つのプロパティから3つの重要なものに削減 */
      transition: background-color 0.2s ease,
                  transform 0.2s ease,
                  box-shadow 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .sub-nav-cat::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .sub-nav-cat[data-cat="basic"] { --cat-color: var(--cat-basic); --cat-bg: var(--cat-basic-light); }
    .sub-nav-cat[data-cat="comm"] { --cat-color: var(--cat-comm); --cat-bg: var(--cat-comm-light); }
    .sub-nav-cat[data-cat="advanced"] { --cat-color: var(--cat-advanced); --cat-bg: var(--cat-advanced-light); }

    .sub-nav-cat:hover {
      border-color: var(--cat-color);
      color: var(--cat-color);
      transform: translateY(-2px);
    }

    .sub-nav-cat.active {
      border-color: var(--cat-color);
      background: var(--cat-bg);
      color: var(--cat-color);
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }

    .sub-nav-sections {
      display: flex;
      gap: 6px;
    }

    .sub-nav-section {
      width: 36px;
      height: 36px;
      border: 2px solid var(--border);
      border-radius: 10px;
      background: transparent;
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 700;
      font-family: 'Space Grotesk', monospace;
      cursor: pointer;
      transition: border-color 0.2s ease, color 0.2s ease, background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .sub-nav-section:hover {
      border-color: var(--text);
      color: var(--text);
      transform: scale(1.08);
    }

    .sub-nav-section.active {
      background: var(--text);
      border-color: var(--text);
      color: var(--bg);
      box-shadow: var(--shadow-sm);
    }

    /* ===== MAIN CONTENT AREA ===== */
    .main-content {
      padding-top: 60px;
      min-height: 100vh;
    }

    .main-content.has-subnav {
      padding-top: 152px;
    }

    /* ===== HOME VIEW ===== */
    .view-home {
      min-height: calc(100vh - 60px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 40px;
      position: relative;
      overflow: hidden;
    }

    .home-bg {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 60% at 50% 20%, var(--cat-basic-light) 0%, transparent 50%),
        radial-gradient(ellipse 60% 50% at 20% 80%, var(--cat-comm-light) 0%, transparent 40%),
        radial-gradient(ellipse 50% 40% at 80% 70%, var(--cat-advanced-light) 0%, transparent 40%);
      opacity: 0.6;
    }

    .home-content {
      position: relative;
      z-index: 1;
      max-width: 800px;
    }

    .home-label {
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 24px;
      animation: fadeInUp 0.6s ease-out 0.1s both;
    }

    .home-title {
      font-family: 'New York', 'Georgia', serif;
      font-size: clamp(48px, 10vw, 120px);
      font-weight: 400;
      line-height: 1.1;
      letter-spacing: -0.03em;
      margin-bottom: 24px;
      animation: fadeInUp 0.6s ease-out 0.2s both;
    }

    .home-title em {
      font-style: normal;
      background: linear-gradient(135deg, var(--coord) 0%, var(--subord) 50%, var(--correl) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .home-subtitle {
      font-size: 20px;
      color: var(--text-secondary);
      max-width: 500px;
      margin: 0 auto 48px;
      line-height: 1.7;
      animation: fadeInUp 0.6s ease-out 0.3s both;
    }

    .home-cta {
      display: flex;
      gap: 16px;
      justify-content: center;
      animation: fadeInUp 0.6s ease-out 0.4s both;
    }

    .btn-primary {
      padding: 18px 40px;
      background: var(--text);
      color: var(--bg);
      border: none;
      border-radius: 100px;
      font-size: 16px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }

    .btn-secondary {
      padding: 18px 40px;
      background: transparent;
      color: var(--text);
      border: 2px solid var(--border);
      border-radius: 100px;
      font-size: 16px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: border-color 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
    }

    .btn-secondary:hover {
      border-color: var(--text);
      background: var(--card);
      box-shadow: var(--shadow);
    }

    /* ===== OVERVIEW VIEW ===== */
    .view-overview {
      padding: 60px 48px 100px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .overview-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .overview-label {
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .overview-title {
      font-family: 'New York', 'Georgia', serif;
      font-size: clamp(32px, 5vw, 48px);
      font-weight: 400;
      letter-spacing: -0.02em;
    }

    /* Conjunction Reference Sections */
    .conj-section {
      margin-bottom: 80px;
    }

    .conj-section-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 32px;
    }

    .conj-section-icon {
      width: 56px;
      height: 56px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      flex-shrink: 0;
    }

    .conj-section.coord .conj-section-icon { background: var(--coord-light); }
    .conj-section.subord .conj-section-icon { background: var(--subord-light); }
    .conj-section.correl .conj-section-icon { background: var(--correl-light); }
    .conj-section.adverb .conj-section-icon { background: var(--adverb-light); }

    .conj-section-title {
      font-family: 'New York', 'Georgia', serif;
      font-size: clamp(24px, 4vw, 32px);
      font-weight: 400;
    }

    .conj-section-title-jp {
      font-family: 'Noto Serif JP', 'Yu Mincho', serif;
      font-size: 14px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .conj-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }

    .conj-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 28px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-visible);
      border-left: 4px solid var(--card-accent);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      animation: fadeIn 0.4s ease backwards;
      transform-style: preserve-3d;
    }

    .conj-card:hover {
      transform: translateY(-4px) rotateX(2deg) rotateY(-1deg);
      box-shadow: var(--shadow-lg);
    }

    .conj-card:nth-child(1) { animation-delay: 0s; }
    .conj-card:nth-child(2) { animation-delay: 0.05s; }
    .conj-card:nth-child(3) { animation-delay: 0.1s; }
    .conj-card:nth-child(4) { animation-delay: 0.15s; }
    .conj-card:nth-child(5) { animation-delay: 0.2s; }
    .conj-card:nth-child(6) { animation-delay: 0.25s; }
    .conj-card:nth-child(7) { animation-delay: 0.3s; }
    .conj-card:nth-child(8) { animation-delay: 0.35s; }

    .conj-section.coord .conj-card { --card-accent: var(--coord); }
    .conj-section.subord .conj-card { --card-accent: var(--subord); }
    .conj-section.correl .conj-card { --card-accent: var(--correl); }
    .conj-section.adverb .conj-card { --card-accent: var(--adverb); }

    .conj-card-word {
      font-family: 'New York', 'Georgia', serif;
      font-size: 26px;
      font-weight: 400;
      color: var(--card-accent);
      margin-bottom: 4px;
    }

    .conj-card-meaning {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }

    .conj-card-example {
      margin-bottom: 16px;
    }

    .conj-card-example-en {
      font-size: 17px;
      line-height: 1.7;
      margin-bottom: 6px;
    }

    .conj-card-example-en strong {
      color: var(--card-accent);
      font-weight: 700;
    }

    .conj-card-example-jp {
      font-size: 15px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .conj-card-tip {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 14px 16px;
      background: var(--bg-warm);
      border-radius: var(--radius-sm);
      margin-top: 16px;
    }

    [data-theme="dark"] .conj-card-tip {
      background: var(--bg);
    }

    .conj-card-tip-icon {
      font-size: 16px;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .conj-card-tip-text {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-secondary);
    }

    /* ===== QUESTION VIEW ===== */
    .view-question {
      padding: 40px 48px 100px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .question-header {
      margin-bottom: 32px;
    }

    .question-category-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .question-category-badge.basic {
      background: var(--cat-basic-light);
      color: var(--cat-basic);
    }

    .question-category-badge.comm {
      background: var(--cat-comm-light);
      color: var(--cat-comm);
    }

    .question-category-badge.advanced {
      background: var(--cat-advanced-light);
      color: var(--cat-advanced);
    }

    .question-title {
      font-family: 'New York', 'Georgia', serif;
      font-size: clamp(24px, 4vw, 32px);
      font-weight: 400;
      margin-bottom: 8px;
    }

    .question-subtitle {
      font-size: 15px;
      color: var(--text-secondary);
    }

    /* Progress */
    .progress-wrap {
      margin-bottom: 32px;
    }

    .progress-bar-bg {
      height: 6px;
      background: var(--bg-warm);
      border-radius: 100px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--coord), var(--subord));
      border-radius: 100px;
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 8px;
      text-align: right;
    }

    /* Search */
    .search-wrap {
      position: relative;
      margin-bottom: 32px;
    }

    .search-input {
      width: 100%;
      padding: 16px 20px 16px 52px;
      border: 2px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--card);
      font-size: 15px;
      font-family: inherit;
      color: var(--text);
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--coord-light);
    }

    .search-input::placeholder {
      color: var(--text-muted);
    }

    .search-icon {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      font-size: 18px;
    }

    /* Questions List */
    /* Performance: CSS containment limits repaints to this container */
    /* パフォーマンス: CSS containmentで再描画をこのコンテナに限定 */
    .questions-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
      contain: content;
    }

    /* Question Card */
    /* Performance fix: removed staggered animations that cause GPU overload with many cards */
    /* パフォーマンス修正: 多数のカードでGPU過負荷を引き起こすアニメーションを削除 */
    .qcard {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-visible);
      box-shadow: var(--shadow);
      overflow: hidden;
      /* Card reveal animation - starts hidden */
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease,
                  transform 0.5s ease,
                  box-shadow 0.3s ease;
    }

    .qcard.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .qcard.visible:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }

    /* Staggered reveal delays */
    .qcard:nth-child(1) { transition-delay: 0s; }
    .qcard:nth-child(2) { transition-delay: 0.05s; }
    .qcard:nth-child(3) { transition-delay: 0.1s; }
    .qcard:nth-child(4) { transition-delay: 0.15s; }
    .qcard:nth-child(5) { transition-delay: 0.2s; }

    /* Dark mode glassy cards with visible shadows */
    [data-theme="dark"] .qcard {
      background: var(--card);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--border-visible);
      box-shadow: var(--shadow);
      contain: layout style;
    }

    .qcard-question, .qcard-buttons, .qcard-left, .qcard-right {
      box-sizing: border-box;
    }

    .qcard-buttons, .toggle-btn-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .qcard-buttons {
      padding: 0 24px 20px;
    }

    /* Dual/Split view */
    [data-view="dual"] .qcard {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      grid-template-areas:
        "question question"
        "left right";
    }

    [data-view="dual"] .qcard-buttons {
      display: none;
    }

    [data-view="dual"] .qcard-question {
      grid-area: question;
      padding: 24px;
      border-bottom: 1px solid var(--border);
    }

    [data-view="dual"] .qcard-left {
      grid-area: left;
      padding: 24px;
      border-right: 1px solid var(--border);
    }

    [data-view="dual"] .qcard-right {
      grid-area: right;
      padding: 24px;
      background: var(--card);
    }

    [data-view="dual"] .collapsible {
      display: none;
    }

    [data-view="dual"] .collapsible.open {
      display: block;
      margin-top: 16px;
    }

    /* Single view */
    [data-view="single"] .qcard {
      display: block;
    }

    [data-view="single"] .qcard-buttons {
      display: flex;
    }

    [data-view="single"] .toggle-btn-row {
      display: none;
    }

    [data-view="single"] .qcard-question {
      padding: 24px 24px 16px;
    }

    [data-view="single"] .qcard-left {
      padding: 0 24px 0;
      border-right: none;
    }

    [data-view="single"] .qcard-right {
      padding: 0 24px 24px;
      background: transparent;
    }

    [data-view="single"] .collapsible {
      display: none;
    }

    [data-view="single"] .collapsible.open {
      display: block;
      margin-top: 16px;
    }

    @media (max-width: 800px) {
      [data-view="dual"] .qcard {
        grid-template-columns: 1fr;
        grid-template-areas:
          "question"
          "left"
          "right";
      }
      [data-view="dual"] .qcard-left {
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
    }

    .qnum {
      display: inline-block;
      font-weight: 700;
      font-size: 12px;
      color: var(--accent);
      background: var(--coord-light);
      padding: 4px 12px;
      border-radius: 100px;
      margin-bottom: 12px;
    }

    .qtext {
      font-size: var(--fs-qtext);
      line-height: 1.8;
      margin-bottom: 12px;
    }

    .choices, .scramble {
      padding: 14px 16px;
      border-radius: var(--radius-sm);
      font-size: 17px;
    }

    .qcard-question .choices:last-child,
    .qcard-question .scramble:last-child {
      margin-bottom: 0;
    }

    .choices {
      background: var(--correl-light);
      border-left: 3px solid var(--correl);
    }

    .scramble {
      background: var(--subord-light);
      border-left: 3px solid var(--subord);
      font-family: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
    }

    .toggle-btn {
      flex: 1;
      min-width: 80px;
      min-height: 44px;  /* Apple HIG touch target */
      padding: 12px 24px;
      border: none;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      /* Default shadow for elevated look */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12),
                  0 4px 12px rgba(0, 0, 0, 0.08);
      /* Spring effect transition */
      transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1),
                  box-shadow 0.2s ease,
                  background-color 0.2s ease;
    }

    .toggle-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .toggle-btn:active {
      transform: translateY(0) scale(0.96);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .toggle-btn.vocab { background: var(--correl); color: white; }
    .toggle-btn.hint { background: var(--coord); color: white; }
    .toggle-btn.answer { background: var(--adverb); color: white; }

    /* Mobile: larger touch targets */
    @media (max-width: 768px) {
      .toggle-btn {
        min-height: 48px;
        padding: 14px 28px;
        font-size: 14px;
      }
    }

    .box {
      border-radius: var(--radius-sm);
      padding: 16px;
      font-size: 17px;
      line-height: 1.7;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
      transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }

    .box:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
      border-color: var(--border-visible);
    }

    .vocab-box {
      background: var(--card);
      border-left: 3px solid var(--correl);
    }

    .hint-box {
      background: var(--card);
      border-left: 3px solid var(--coord);
    }

    .hint-item {
      padding: 8px 0;
      border-bottom: 1px solid rgba(13, 148, 136, 0.15);
    }

    .hint-item:last-child {
      border-bottom: none;
    }

    .ans-box {
      background: var(--card);
      border-left: 3px solid var(--adverb);
    }

    /* Dark mode box styling */
    [data-theme="dark"] .box {
      background: var(--card);
      border-color: var(--border-visible);
      box-shadow: var(--shadow-sm);
    }

    [data-theme="dark"] .box:hover {
      box-shadow: var(--shadow);
    }

    .choice-explanations {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(90, 154, 110, 0.2);
    }

    .choice-exp {
      padding: 8px 0;
      font-size: 16px;
      line-height: 1.6;
      border-bottom: 1px solid rgba(139, 129, 120, 0.12);
    }

    .choice-exp:last-child {
      border-bottom: none;
    }

    .choice-exp.correct {
      color: var(--adverb);
      font-weight: 600;
    }

    .choice-exp.wrong {
      color: var(--text-secondary);
    }

    .vocab-item {
      padding: 6px 0;
      border-bottom: 1px solid rgba(155,127,207,0.15);
    }

    .vocab-item:last-child { border-bottom: none; }

    .vocab-word {
      font-weight: 700;
      color: var(--correl);
      margin-right: 8px;
    }

    .box-label {
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 12px;
      display: block;
    }

    .jp-text {
      color: var(--text-secondary);
      margin-top: 12px;
      padding-bottom: 12px;
      font-size: 16px;
      border-bottom: 1px solid rgba(139, 129, 120, 0.15);
    }

    .jp-text:last-child {
      border-bottom: none;
    }

    .grammar-ref {
      background: var(--subord-light);
      border-left: 3px solid var(--subord);
      padding: 12px 14px;
      border-radius: var(--radius-sm);
      font-size: 15px;
      margin-top: 12px;
    }

    .no-match { display: none !important; }

    /* Footer */
    footer {
      text-align: center;
      padding: 40px;
      color: var(--text-muted);
      font-size: 13px;
      border-top: 1px solid var(--border);
    }

    /* ===== VIEW VISIBILITY ===== */
    .view-home,
    .view-overview,
    .view-question {
      display: none;
    }

    .view-home.active { display: flex; }
    .view-overview.active { display: block; }
    .view-question.active { display: block; }

    /* ===== CSS ANIMATIONS ===== */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(24px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .collapsible.open {
      animation: slideInSmooth 0.35s cubic-bezier(0.22, 1, 0.36, 1);
    }

    @keyframes slideInSmooth {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Reduced motion support for accessibility */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
      html {
        scroll-behavior: auto;
      }
    }

    /* Responsive */
    @media (max-width: 900px) {
      .conj-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 768px) {
      .top-nav {
        padding: 0 16px;
        height: 56px;
      }

      .top-nav-logo {
        font-size: 13px;
      }

      .top-nav-center {
        display: none;
      }

      .top-nav-right {
        gap: 6px;
      }

      .view-toggle-nav {
        display: none;
      }

      .sub-nav {
        padding: 12px 16px;
        gap: 10px;
      }

      .sub-nav-categories {
        flex-wrap: wrap;
        justify-content: center;
        gap: 6px;
      }

      .sub-nav-cat {
        padding: 8px 16px;
        font-size: 13px;
      }

      .sub-nav-sections {
        gap: 4px;
      }

      .sub-nav-section {
        width: 32px;
        height: 32px;
        font-size: 13px;
      }

      .main-content {
        padding-top: 56px;
      }

      .main-content.has-subnav {
        padding-top: 140px;
      }

      .view-home {
        padding: 24px;
      }

      .home-title {
        font-size: clamp(40px, 12vw, 80px);
      }

      .home-cta {
        flex-direction: column;
        width: 100%;
      }

      .btn-primary, .btn-secondary {
        width: 100%;
        padding: 16px 32px;
      }

      .view-overview,
      .view-question {
        padding: 32px 20px 80px;
      }
    }

    /* Mobile nav drawer */
    @media (max-width: 768px) {
      .mobile-nav-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border: 1px solid var(--border);
        border-radius: 10px;
        background: var(--card);
        cursor: pointer;
        font-size: 20px;
      }

      .mobile-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--card);
        border-top: 1px solid var(--border);
        padding: 12px 16px;
        display: flex;
        justify-content: space-around;
        z-index: 1001;
        box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
      }

      .mobile-nav-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        padding: 8px 16px;
        border: none;
        background: transparent;
        color: var(--text-secondary);
        font-size: 11px;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        border-radius: 12px;
        transition: color 0.2s ease, background-color 0.2s ease;
      }

      .mobile-nav-btn.active {
        color: var(--accent);
        background: var(--coord-light);
      }

      .mobile-nav-btn-icon {
        font-size: 20px;
      }

      footer {
        padding-bottom: 100px;
      }
    }

    @media (min-width: 769px) {
      .mobile-nav {
        display: none;
      }
    }

    /* ===== LARGE SCREEN OPTIMIZATION ===== */
    @media (min-width: 1200px) {
      .view-question {
        max-width: 1100px;
      }
    }

    @media (min-width: 1440px) {
      .view-question {
        max-width: 1250px;
        padding: 48px 56px 100px;
      }
      .view-overview {
        max-width: 1500px;
      }
    }

    @media (min-width: 1728px) {
      .view-question {
        max-width: 1400px;
        padding: 56px 64px 100px;
      }
      .view-overview {
        max-width: 1600px;
      }
      .qtext {
        font-size: 20px;
      }
    }
  </style>
</head>
<body data-view="single" data-exam-id="ds-lesson15-conjunctions">

  <!-- ===== TOP NAVIGATION BAR ===== -->
  <nav class="top-nav" id="topNav">
    <div class="top-nav-logo">DUAL SCOPE</div>
    <div class="top-nav-center">
      <button class="top-nav-link active" data-nav="home" onclick="Router.navigate('home')">Home</button>
      <button class="top-nav-link" data-nav="overview" onclick="Router.navigate('overview')">Overview</button>
      <button class="top-nav-link" data-nav="question" onclick="Router.navigate('question')">Question</button>
    </div>
    <div class="top-nav-right">
      <div class="view-toggle-nav">
        <button class="view-btn-nav active" data-view="single" onclick="setView('single')">Single</button>
        <button class="view-btn-nav" data-view="dual" onclick="setView('dual')">Split</button>
      </div>
      <button class="top-nav-theme" onclick="toggleTheme()" title="Toggle theme">
        <span class="theme-icon">&#9728;&#65039;</span>
      </button>
    </div>
  </nav>

  <!-- ===== SUB NAVIGATION (Question view only) ===== -->
  <nav class="sub-nav" id="subNav">
    <div class="sub-nav-categories">
      <button class="sub-nav-cat active" data-cat="basic" onclick="Router.setCategory('basic')">&#22522;&#26412;&#21839;&#38988;</button>
      <button class="sub-nav-cat" data-cat="comm" onclick="Router.setCategory('comm')">For Communication</button>
      <button class="sub-nav-cat" data-cat="advanced" onclick="Router.setCategory('advanced')">&#30330;&#23637;&#21839;&#38988;</button>
    </div>
    <div class="sub-nav-sections" id="sectionToggles"></div>
  </nav>

  <!-- ===== MAIN CONTENT ===== -->
  <main class="main-content" id="mainContent">

    <!-- HOME VIEW -->
    <section class="view-home active" id="viewHome">
      <div class="home-bg"></div>
      <div class="home-content">
        <p class="home-label">Lesson 15</p>
        <h1 class="home-title">&#25509;&#32154;&#35422;</h1>
        <p class="home-subtitle">Master the art of connecting ideas in English with conjunctions.</p>
        <div class="home-cta">
          <button class="btn-primary" onclick="Router.navigate('question')">Start Learning</button>
          <button class="btn-secondary" onclick="Router.navigate('overview')">Overview</button>
        </div>
      </div>
    </section>

    <!-- OVERVIEW VIEW -->
    <section class="view-overview" id="viewOverview">
      <div class="overview-header">
        <p class="overview-label">Reference Guide</p>
        <h2 class="overview-title">Conjunction Types</h2>
      </div>

      <!-- Coordinating Conjunctions -->
      <section class="conj-section coord">
        <div class="conj-section-header">
          <div class="conj-section-icon">&#128279;</div>
          <div>
            <h2 class="conj-section-title">Coordinating Conjunctions</h2>
            <p class="conj-section-title-jp">&#31561;&#20301;&#25509;&#32154;&#35422;</p>
          </div>
        </div>
        <div class="conj-grid">
          <div class="conj-card">
            <div class="conj-card-word">and</div>
            <div class="conj-card-meaning">&#12381;&#12375;&#12390;&#12289;&#65374;&#12392;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I like coffee <strong>and</strong> tea.</p>
              <p class="conj-card-example-jp">&#31169;&#12399;&#12467;&#12540;&#12498;&#12540;&#12392;&#32005;&#33590;&#12364;&#22909;&#12365;&#12391;&#12377;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">2&#12388;&#20197;&#19978;&#12398;&#12418;&#12398;&#12434;&#12300;&#36861;&#21152;&#12301;&#12377;&#12427;&#12392;&#12365;&#12395;&#20351;&#12358;&#26368;&#12418;&#22522;&#26412;&#30340;&#12394;&#25509;&#32154;&#35422;&#12290;&#21629;&#20196;&#25991; + and &#12391;&#12300;&#65374;&#12375;&#12394;&#12373;&#12356;&#12289;&#12381;&#12358;&#12377;&#12428;&#12400;&#12301;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">but</div>
            <div class="conj-card-meaning">&#12375;&#12363;&#12375;&#12289;&#12391;&#12418;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I want to go, <strong>but</strong> I'm too busy.</p>
              <p class="conj-card-example-jp">&#34892;&#12365;&#12383;&#12356;&#12398;&#12391;&#12377;&#12364;&#12289;&#24537;&#12375;&#12377;&#12366;&#12414;&#12377;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#21069;&#24460;&#12398;&#20869;&#23481;&#12364;&#12300;&#23550;&#29031;&#30340;&#12301;&#12414;&#12383;&#12399;&#12300;&#36870;&#12301;&#12398;&#12392;&#12365;&#12395;&#20351;&#12358;&#12290;not A but B &#12391;&#12300;A&#12391;&#12399;&#12394;&#12367;B&#12301;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">or</div>
            <div class="conj-card-meaning">&#12414;&#12383;&#12399;&#12289;&#12373;&#12418;&#12394;&#12356;&#12392;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">Hurry up, <strong>or</strong> you'll miss the train.</p>
              <p class="conj-card-example-jp">&#24613;&#12366;&#12394;&#12373;&#12356;&#12289;&#12373;&#12418;&#12394;&#12356;&#12392;&#38651;&#36554;&#12395;&#20055;&#12426;&#36933;&#12428;&#12414;&#12377;&#12424;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#36984;&#25246;&#32930;&#12434;&#31034;&#12377;&#12290;&#21629;&#20196;&#25991; + or &#12391;&#12300;&#65374;&#12375;&#12394;&#12373;&#12356;&#12289;&#12373;&#12418;&#12394;&#12356;&#12392;&#12301;&#12392;&#12356;&#12358;&#35686;&#21578;&#12398;&#24847;&#21619;&#12395;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">so</div>
            <div class="conj-card-meaning">&#12384;&#12363;&#12425;&#12289;&#12381;&#12428;&#12391;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">It was raining, <strong>so</strong> we stayed home.</p>
              <p class="conj-card-example-jp">&#38632;&#12364;&#38477;&#12387;&#12390;&#12356;&#12383;&#12398;&#12391;&#12289;&#23478;&#12395;&#12356;&#12414;&#12375;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#21407;&#22240;&#12363;&#12425;&#32080;&#26524;&#12434;&#23566;&#12367;&#12290;&#21069;&#12398;&#25991;&#12364;&#21407;&#22240;&#12289;&#24460;&#12398;&#25991;&#12364;&#32080;&#26524;&#12392;&#12356;&#12358;&#22240;&#26524;&#38306;&#20418;&#12434;&#34920;&#12377;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">for</div>
            <div class="conj-card-meaning">&#12392;&#12356;&#12358;&#12398;&#12399;&#65374;&#12384;&#12363;&#12425;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I stayed still, <strong>for</strong> I didn't know what to do.</p>
              <p class="conj-card-example-jp">&#12376;&#12387;&#12392;&#12375;&#12390;&#12356;&#12383;&#12289;&#12392;&#12356;&#12358;&#12398;&#12399;&#20309;&#12434;&#12377;&#12428;&#12400;&#12356;&#12356;&#12363;&#12431;&#12363;&#12425;&#12394;&#12363;&#12387;&#12383;&#12363;&#12425;&#12384;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#35036;&#36275;&#30340;&#12395;&#29702;&#30001;&#12434;&#36848;&#12409;&#12427;&#12290;&#25991;&#38957;&#12395;&#12399;&#20351;&#12360;&#12394;&#12356;&#12290;&#12420;&#12420;&#25991;&#35486;&#30340;&#12394;&#34920;&#29694;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">yet</div>
            <div class="conj-card-meaning">&#12375;&#12363;&#12375;&#12289;&#12381;&#12428;&#12391;&#12418;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">She's tired, <strong>yet</strong> she keeps working.</p>
              <p class="conj-card-example-jp">&#24444;&#22899;&#12399;&#30130;&#12428;&#12390;&#12356;&#12427;&#12364;&#12289;&#12381;&#12428;&#12391;&#12418;&#20685;&#12365;&#32154;&#12369;&#12390;&#12356;&#12427;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">but &#12424;&#12426;&#24375;&#12356;&#23550;&#27604;&#12434;&#34920;&#12377;&#12290;&#20104;&#24819;&#12395;&#21453;&#12377;&#12427;&#32080;&#26524;&#12434;&#24375;&#35519;&#12377;&#12427;&#12392;&#12365;&#12395;&#20351;&#12358;</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Correlative Conjunctions -->
      <section class="conj-section correl">
        <div class="conj-section-header">
          <div class="conj-section-icon">&#10024;</div>
          <div>
            <h2 class="conj-section-title">Correlative Conjunctions</h2>
            <p class="conj-section-title-jp">&#30456;&#38306;&#25509;&#32154;&#35422;</p>
          </div>
        </div>
        <div class="conj-grid">
          <div class="conj-card">
            <div class="conj-card-word">both A and B</div>
            <div class="conj-card-meaning">A&#12418;B&#12418;&#20001;&#26041;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Both</strong> coffee <strong>and</strong> tea are popular.</p>
              <p class="conj-card-example-jp">&#12467;&#12540;&#12498;&#12540;&#12418;&#32005;&#33590;&#12418;&#20001;&#26041;&#20154;&#27671;&#12364;&#12354;&#12426;&#12414;&#12377;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">2&#12388;&#12398;&#35201;&#32032;&#12434;&#31561;&#12375;&#12367;&#24375;&#35519;&#12290;&#20027;&#35486;&#12395;&#12394;&#12427;&#22580;&#21512;&#12399;&#24120;&#12395;&#35079;&#25968;&#25201;&#12356;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">either A or B</div>
            <div class="conj-card-meaning">A&#12363;B&#12363;&#12393;&#12385;&#12425;&#12363;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">You can have <strong>either</strong> coffee <strong>or</strong> tea.</p>
              <p class="conj-card-example-jp">&#12467;&#12540;&#12498;&#12540;&#12363;&#32005;&#33590;&#12398;&#12393;&#12385;&#12425;&#12363;&#12434;&#36984;&#12409;&#12414;&#12377;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">2&#25246;&#12398;&#36984;&#25246;&#32930;&#12434;&#31034;&#12377;&#12290;&#20027;&#35486;&#12395;&#12394;&#12427;&#22580;&#21512;&#12289;&#21205;&#35422;&#12399;B&#12395;&#19968;&#33268;&#12373;&#12379;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">neither A nor B</div>
            <div class="conj-card-meaning">A&#12418;B&#12418;&#12393;&#12385;&#12425;&#12418;&#65374;&#12394;&#12356;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Neither</strong> he <strong>nor</strong> I was wrong.</p>
              <p class="conj-card-example-jp">&#24444;&#12418;&#31169;&#12418;&#12393;&#12385;&#12425;&#12418;&#38291;&#36949;&#12387;&#12390;&#12356;&#12394;&#12363;&#12387;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#20001;&#26041;&#12434;&#21542;&#23450;&#12377;&#12427;&#12290;&#20027;&#35486;&#12395;&#12394;&#12427;&#22580;&#21512;&#12289;&#21205;&#35422;&#12399;B&#12395;&#19968;&#33268;&#12373;&#12379;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">not only A but also B</div>
            <div class="conj-card-meaning">A&#12384;&#12369;&#12391;&#12394;&#12367;B&#12418;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">She is <strong>not only</strong> smart <strong>but also</strong> kind.</p>
              <p class="conj-card-example-jp">&#24444;&#22899;&#12399;&#36066;&#12356;&#12384;&#12369;&#12391;&#12394;&#12367;&#35242;&#20999;&#12391;&#12418;&#12354;&#12427;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">B&#12395;&#37325;&#28857;&#12434;&#32622;&#12367;&#34920;&#29694;&#12290;&#20027;&#35486;&#12395;&#12394;&#12427;&#22580;&#21512;&#12289;&#21205;&#35422;&#12399;B&#12395;&#19968;&#33268;&#12373;&#12379;&#12427;</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Subordinating Conjunctions -->
      <section class="conj-section subord">
        <div class="conj-section-header">
          <div class="conj-section-icon">&#9200;</div>
          <div>
            <h2 class="conj-section-title">Subordinating Conjunctions</h2>
            <p class="conj-section-title-jp">&#24467;&#20301;&#25509;&#32154;&#35422;</p>
          </div>
        </div>
        <div class="conj-grid">
          <div class="conj-card">
            <div class="conj-card-word">when / while</div>
            <div class="conj-card-meaning">&#65374;&#12377;&#12427;&#12392;&#12365; / &#65374;&#12375;&#12390;&#12356;&#12427;&#38291;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I was reading <strong>when</strong> he called.</p>
              <p class="conj-card-example-jp">&#24444;&#12364;&#38651;&#35441;&#12375;&#12383;&#12392;&#12365;&#12289;&#31169;&#12399;&#35501;&#26360;&#12434;&#12375;&#12390;&#12356;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">while &#12399;&#32153;&#32154;&#30340;&#12394;&#21205;&#20316;&#12395;&#20351;&#12358;&#12290;while &#12395;&#12399;&#12300;&#19968;&#26041;&#12391;&#12399;&#12301;&#12392;&#12356;&#12358;&#35698;&#27497;&#12398;&#24847;&#21619;&#12418;&#12354;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">because / since</div>
            <div class="conj-card-meaning">&#65374;&#12394;&#12398;&#12391; / &#65374;&#12384;&#12363;&#12425;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Since</strong> you know, you should help her.</p>
              <p class="conj-card-example-jp">&#21531;&#12399;&#30693;&#12387;&#12390;&#12356;&#12427;&#12398;&#12384;&#12363;&#12425;&#12289;&#24444;&#22899;&#12434;&#21161;&#12369;&#12427;&#12409;&#12365;&#12384;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">because &#12399;&#30452;&#25509;&#30340;&#12394;&#29702;&#30001;&#12289;since &#12399;&#26082;&#30693;&#12398;&#20107;&#23455;&#12434;&#29702;&#30001;&#12392;&#12375;&#12390;&#35036;&#36275;&#30340;&#12395;&#36848;&#12409;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">if / unless</div>
            <div class="conj-card-meaning">&#12418;&#12375;&#65374;&#12394;&#12425; / &#65374;&#12391;&#12394;&#12356;&#38480;&#12426;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I won't go <strong>unless</strong> you come too.</p>
              <p class="conj-card-example-jp">&#21531;&#12418;&#26469;&#12394;&#12356;&#38480;&#12426;&#12289;&#31169;&#12399;&#34892;&#12363;&#12394;&#12356;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">unless = if not&#12290;&#26465;&#20214;&#12434;&#34920;&#12377;&#21103;&#35422;&#31680;&#12391;&#12399;&#26410;&#26469;&#12398;&#12371;&#12392;&#12418;&#29694;&#22312;&#24418;&#12391;&#34920;&#12377;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">although / though</div>
            <div class="conj-card-meaning">&#65374;&#12384;&#12369;&#12428;&#12393;&#12418;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Although</strong> tired, he kept working.</p>
              <p class="conj-card-example-jp">&#30130;&#12428;&#12390;&#12356;&#12383;&#12369;&#12428;&#12393;&#12418;&#12289;&#24444;&#12399;&#20685;&#12365;&#32154;&#12369;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#35698;&#27497;&#12434;&#34920;&#12377;&#12290;even though &#12391;&#24375;&#35519;&#12290;though &#12399;&#25991;&#26411;&#12395;&#21103;&#35422;&#12392;&#12375;&#12390;&#20351;&#12360;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">as</div>
            <div class="conj-card-meaning">&#65374;&#12377;&#12427;&#12395;&#12388;&#12428;&#12390; / &#65374;&#12398;&#12424;&#12358;&#12395; / &#65374;&#12394;&#12398;&#12391;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>As</strong> time passed, things got better.</p>
              <p class="conj-card-example-jp">&#26178;&#38291;&#12364;&#32076;&#12388;&#12395;&#12388;&#12428;&#12390;&#12289;&#29366;&#27841;&#12399;&#33391;&#12367;&#12394;&#12387;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#26178;&#12539;&#29702;&#30001;&#12539;&#27096;&#24907;&#12394;&#12393;&#22810;&#32681;&#35486;&#12290;as far as&#12300;&#65374;&#12377;&#12427;&#38480;&#12426;&#12301;&#12289;as long as&#12300;&#65374;&#12377;&#12427;&#38291;&#12399;&#12301;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">once</div>
            <div class="conj-card-meaning">&#12356;&#12387;&#12383;&#12435;&#65374;&#12377;&#12427;&#12392;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Once</strong> you start, you can't stop.</p>
              <p class="conj-card-example-jp">&#12356;&#12387;&#12383;&#12435;&#22987;&#12417;&#12427;&#12392;&#12289;&#12420;&#12417;&#12425;&#12428;&#12394;&#12356;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#12300;&#26178;&#12301;&#12392;&#12300;&#26465;&#20214;&#12301;&#12398;&#20001;&#26041;&#12398;&#24847;&#21619;&#12434;&#21547;&#12416;&#12290;&#21103;&#35422;&#31680;&#12394;&#12398;&#12391;&#26410;&#26469;&#12418;&#29694;&#22312;&#24418;&#12391;&#34920;&#12377;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">whether</div>
            <div class="conj-card-meaning">&#65374;&#12363;&#12393;&#12358;&#12363; / &#65374;&#12391;&#12354;&#12429;&#12358;&#12392;&#12394;&#12363;&#12429;&#12358;&#12392;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en"><strong>Whether</strong> he comes or not, we'll start.</p>
              <p class="conj-card-example-jp">&#24444;&#12364;&#26469;&#12424;&#12358;&#12392;&#26469;&#12414;&#12356;&#12392;&#12289;&#22987;&#12417;&#12427;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#21517;&#35422;&#31680;&#12300;&#65374;&#12363;&#12393;&#12358;&#12363;&#12301;&#12392;&#21103;&#35422;&#31680;&#12300;&#65374;&#12391;&#12354;&#12429;&#12358;&#12392;&#12394;&#12363;&#12429;&#12358;&#12392;&#12301;&#12398;2&#12388;&#12398;&#29992;&#27861;&#12364;&#12354;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">so that</div>
            <div class="conj-card-meaning">&#65374;&#12377;&#12427;&#12383;&#12417;&#12395; / &#12381;&#12398;&#32080;&#26524;&#65374;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">Speak louder <strong>so that</strong> everyone can hear.</p>
              <p class="conj-card-example-jp">&#12415;&#12435;&#12394;&#12395;&#32862;&#12371;&#12360;&#12427;&#12424;&#12358;&#12395;&#12289;&#12418;&#12387;&#12392;&#22823;&#12365;&#12394;&#22768;&#12391;&#35441;&#12375;&#12390;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#30446;&#30340;&#12300;&#65374;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#12301;&#12392;&#32080;&#26524;&#12300;&#12381;&#12398;&#32080;&#26524;&#65374;&#12301;&#12398;&#24847;&#21619;&#12364;&#12354;&#12427;</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Conjunctive Adverbs -->
      <section class="conj-section adverb">
        <div class="conj-section-header">
          <div class="conj-section-icon">&#128221;</div>
          <div>
            <h2 class="conj-section-title">Conjunctive Adverbs</h2>
            <p class="conj-section-title-jp">&#25509;&#32154;&#21103;&#35422;</p>
          </div>
        </div>
        <div class="conj-grid">
          <div class="conj-card">
            <div class="conj-card-word">however</div>
            <div class="conj-card-meaning">&#12375;&#12363;&#12375;&#12394;&#12364;&#12425;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">I wanted to go. <strong>However</strong>, I was too busy.</p>
              <p class="conj-card-example-jp">&#34892;&#12365;&#12383;&#12363;&#12387;&#12383;&#12290;&#12375;&#12363;&#12375;&#12394;&#12364;&#12425;&#12289;&#24537;&#12375;&#12377;&#12366;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#25991;&#38957;&#12539;&#25991;&#20013;&#12539;&#25991;&#26411;&#12391;&#20351;&#12360;&#12427;&#12290;&#25991;&#20013;&#12391;&#12399;&#12467;&#12531;&#12510;&#12391;&#21306;&#20999;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">therefore</div>
            <div class="conj-card-meaning">&#12375;&#12383;&#12364;&#12387;&#12390;&#12289;&#12381;&#12428;&#12422;&#12360;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">He studied hard; <strong>therefore</strong>, he passed.</p>
              <p class="conj-card-example-jp">&#24444;&#12399;&#19968;&#29983;&#25080;&#21629;&#21193;&#24375;&#12375;&#12383;&#12290;&#12375;&#12383;&#12364;&#12387;&#12390;&#21512;&#26684;&#12375;&#12383;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#35542;&#29702;&#30340;&#12394;&#32080;&#26524;&#12539;&#32080;&#35542;&#12434;&#23566;&#12367;&#12290;&#12501;&#12457;&#12540;&#12510;&#12523;&#12394;&#25991;&#31456;&#12391;&#12424;&#12367;&#20351;&#12431;&#12428;&#12427;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">moreover / furthermore</div>
            <div class="conj-card-meaning">&#12373;&#12425;&#12395;&#12289;&#12381;&#12398;&#19978;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">He's smart. <strong>Moreover</strong>, he's hardworking.</p>
              <p class="conj-card-example-jp">&#24444;&#12399;&#36066;&#12356;&#12290;&#12373;&#12425;&#12395;&#12289;&#21220;&#21193;&#12384;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#24773;&#22577;&#12434;&#36861;&#21152;&#12377;&#12427;&#12290;&#21069;&#12398;&#20869;&#23481;&#12434;&#35036;&#24375;&#12377;&#12427;&#38555;&#12395;&#20351;&#12358;</span>
            </div>
          </div>
          <div class="conj-card">
            <div class="conj-card-word">otherwise</div>
            <div class="conj-card-meaning">&#12373;&#12418;&#12394;&#12369;&#12428;&#12400;</div>
            <div class="conj-card-example">
              <p class="conj-card-example-en">Study hard; <strong>otherwise</strong>, you'll fail.</p>
              <p class="conj-card-example-jp">&#19968;&#29983;&#25080;&#21629;&#21193;&#24375;&#12375;&#12394;&#12373;&#12356;&#12290;&#12373;&#12418;&#12394;&#12369;&#12428;&#12400;&#33853;&#12385;&#12427;&#12290;</p>
            </div>
            <div class="conj-card-tip">
              <span class="conj-card-tip-icon">&#128161;</span>
              <span class="conj-card-tip-text">&#21542;&#23450;&#30340;&#12394;&#32080;&#26524;&#12408;&#12398;&#35686;&#21578;&#12290;&#20206;&#23450;&#27861;&#12391;&#12418;&#20351;&#12431;&#12428;&#12427;</span>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- QUESTION VIEW -->
    <section class="view-question" id="viewQuestion">
      <div class="question-header">
        <div class="question-category-badge basic" id="categoryBadge">
          <span id="categoryIcon">&#128218;</span>
          <span id="categoryName">&#22522;&#26412;&#21839;&#38988;</span>
        </div>
        <h2 class="question-title" id="sectionTitle">Loading...</h2>
        <p class="question-subtitle" id="sectionSubtitle"></p>
      </div>

      <div class="progress-wrap" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="10" aria-label="Study progress">
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" id="progressBar"></div>
        </div>
        <p class="progress-label" id="progressText">0 / 0 answers revealed</p>
      </div>

      <div class="search-wrap" role="search">
        <span class="search-icon" aria-hidden="true">&#128269;</span>
        <input type="text" class="search-input" id="searchInput" placeholder="Search questions, grammar, vocabulary..." oninput="debouncedSearch()" aria-label="Search questions, grammar, and vocabulary">
      </div>

      <div class="questions-list" id="questionsList"></div>
    </section>

  </main>

  <!-- MOBILE NAVIGATION -->
  <nav class="mobile-nav" id="mobileNav">
    <button class="mobile-nav-btn active" data-nav="home" onclick="Router.navigate('home')">
      <span class="mobile-nav-btn-icon">&#127968;</span>
      <span>Home</span>
    </button>
    <button class="mobile-nav-btn" data-nav="overview" onclick="Router.navigate('overview')">
      <span class="mobile-nav-btn-icon">&#128214;</span>
      <span>Overview</span>
    </button>
    <button class="mobile-nav-btn" data-nav="question" onclick="Router.navigate('question')">
      <span class="mobile-nav-btn-icon">&#10067;</span>
      <span>Question</span>
    </button>
  </nav>

  <footer>DUAL SCOPE English Grammar - Lesson 15: &#25509;&#32154;&#35422;</footer>

<script>
// ===== GRAMMAR DATA =====
const grammarData = {
  sections: [
    {
      title: "[1] 基本問題 1｜語句選択 (1)～(7)",
      open: true,
      questions: [
        {
          num: "(1)",
          text: "Watch your step, (   ) you'll fall down the stairs.",
          choices: "選択肢: and, or, but",
          vocab: [["watch your step", "足元に気をつける"],["fall down", "落ちる、転ぶ"],["stairs", "階段"]],
          hint: ["文の構造を確認：命令文 + 接続詞 + 結果の文","「足元に気をつけて」→ 守らないとどうなる？","命令に従わなかった場合の否定的な結果を表す接続詞は？"],
          answer: "or",
          translation: "足元に気をつけてください，そうでないと階段から落ちますよ",
          explanation: "orは「そうでないと」という意味で、前の命令を守らなかった場合の否定的な結果を示します。",
          grammar: "命令文 + or = ～しなさい、さもないと…",
          choiceExplanations: {
            "or": "○ 正解。「命令文 + or」は「～しなさい、さもないと…」という警告を表す。",
            "and": "× 「命令文 + and」は「～しなさい、そうすれば…」と肯定的な結果を表すので不適切。",
            "but": "× butは前後を対比する接続詞で、命令文との構文では使わない。"
          }
        },
        {
          num: "(2)",
          text: "Hurry up, (   ) you'll be in time for school.",
          choices: "選択肢: and, or, but",
          vocab: [["hurry up", "急ぐ"],["in time for", "～に間に合って"]],
          hint: ["文の構造を確認：命令文 + 接続詞 + 結果の文","「急ぎなさい」→ 従えばどうなる？","命令に従った場合の肯定的な結果を表す接続詞は？"],
          answer: "and",
          translation: "急ぎなさい，そうすれば学校に間に合うよ",
          explanation: "andは前の命令を実行した場合の肯定的な結果を示します。",
          grammar: "命令文 + and = ～しなさい、そうすれば…",
          choiceExplanations: {
            "and": "○ 正解。「命令文 + and」は「～しなさい、そうすれば…」と肯定的結果を表す。",
            "or": "× 「命令文 + or」は否定的な結果（警告）を表すので、文意に合わない。",
            "but": "× butは対比を表す接続詞で、この構文では使用しない。"
          }
        },
        {
          num: "(3)",
          text: "I stood still, (   ) I didn't know what to do.",
          choices: "選択肢: if, although, for",
          vocab: [["stand still", "じっと立っている"],["what to do", "何をすべきか"]],
          hint: ["前の文と後の文の関係を考えよう","後の文が前の文の理由・原因を説明しているか？","補足的に理由を述べる等位接続詞を選ぼう"],
          answer: "for",
          translation: "私はじっと立っていた．というのはどうしたらいいかわからなかったからだ",
          explanation: "forは直前に述べたことの原因・理由を追加的に述べる等位接続詞です。",
          grammar: "for = というのは～だから（補足的な理由）",
          choiceExplanations: {
            "for": "○ 正解。forは補足的に理由を述べる等位接続詞。",
            "if": "× ifは条件を表す接続詞で、理由を表すことはできない。",
            "although": "× althoughは譲歩を表し、「～だけれども」という逆接の意味。"
          }
        },
        {
          num: "(4)",
          text: "(   ) you will succeed or not depends on your effort.",
          choices: "選択肢: That, If, Whether",
          vocab: [["succeed", "成功する"],["depend on", "～次第である"],["effort", "努力"]],
          hint: ["文全体の構造を確認：（  ）節が主語になっている","「or not」が後ろにあることに注目","文頭で主語になれる接続詞はどれか考えよう"],
          answer: "Whether",
          translation: "あなたが成功するかどうかは努力次第だ",
          explanation: "主語になり文頭にくる場合には、ifではなくwhetherを用います。",
          grammar: "Whether S + V (or not) = Sが～かどうか",
          choiceExplanations: {
            "Whether": "○ 正解。文頭で主語になる場合はwhetherを使う。or notとも相性が良い。",
            "That": "× that節は「～ということ」で、「～かどうか」の意味にはならない。",
            "If": "× ifは文頭で主語になる節を導くことができない。"
          }
        },
        {
          num: "(5)",
          text: "She succeeded even (   ) she was young.",
          choices: "選択肢: although, if, though",
          vocab: [["succeed", "成功する"],["young", "若い"]],
          hint: ["前後の文の関係：「若い」のに「成功した」という対比","「even」という強調語に続く接続詞は何が自然か","3つの選択肢のうち、evenと結合できるのはどれ？"],
          answer: "though",
          translation: "彼女は若かったが，成功した",
          explanation: "強調する場合はeven thoughとなり、even althoughとは言いません。",
          grammar: "even though = ～だけれども（強調、実際の事実）",
          choiceExplanations: {
            "though": "○ 正解。even thoughで「～だけれども」と強調された譲歩を表す。",
            "although": "× even althoughという表現は使わない。althoughはevenと結合しない。",
            "if": "× even ifは「たとえ～でも」で仮定の譲歩。ここは事実なので不適切。"
          }
        },
        {
          num: "(6)",
          text: "(   ) it grew darker, it snowed more and more.",
          choices: "選択肢: As, Because, Since",
          vocab: [["grow dark", "暗くなる"],["more and more", "ますます"],["snow", "雪が降る"]],
          hint: ["主節に「more and more」という変化の表現がある","2つの変化が連動して進行している","比例・変化を表す接続詞を選ぼう"],
          answer: "As",
          translation: "暗くなるにつれて，ますます雪が降ってきた",
          explanation: "as節には事態の経過を表す表現が、主節には比較級を伴う表現がくることが多いです。",
          grammar: "As S + V, S' + V'（比較級） = ～するにつれて",
          choiceExplanations: {
            "As": "○ 正解。Asは「～するにつれて」と比例・変化を表す。比較級と相性が良い。",
            "Because": "× Becauseは理由を表す。「暗くなったから雪が降った」は意味が不自然。",
            "Since": "× Sinceは理由または時を表すが、比例の意味はない。"
          }
        },
        {
          num: "(7)",
          text: "(   ) you start reading the book, you cannot stop it.",
          choices: "選択肢: Though, Whether, Once",
          vocab: [["start reading", "読み始める"],["cannot stop", "やめられない"]],
          hint: ["「読み始める」と「やめられない」の関係は？","ある行動を開始した後、それが継続する状態","時と条件の両方の意味を持つ接続詞を選ぼう"],
          answer: "Once",
          translation: "その本はいったん読み始めたら，やめられない",
          explanation: "接続詞のonceは「時」と「条件」の両方の意味を合わせもちます。",
          grammar: "Once S + V = いったん～すると",
          choiceExplanations: {
            "Once": "○ 正解。「いったん～すると」という時と条件を表す接続詞。",
            "Though": "× Thoughは「～だけれども」という譲歩で、文意に合わない。",
            "Whether": "× Whetherは「～かどうか」で、ここでは意味が通らない。"
          }
        }
      ]
    },
    {
      title: "[2] 基本問題 2｜空所補充 (1)～(5)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "アンジェラの手料理はおいしいし，健康にもよい．<br>Angela's homemade cooking is (   ) delicious (   ) healthy.",
          vocab: [["homemade", "手作りの"],["delicious", "おいしい"],["healthy", "健康的な"]],
          hint: ["2つの形容詞が並列されている構造に注目","両方の性質を肯定している文","「AもBも」と2つを等しく強調する相関接続詞は？"],
          answer: "both, and",
          explanation: "2つの要素を等しく強調する表現です。",
          grammar: "both A and B = AもBも"
        },
        {
          num: "(2)",
          text: "それは毒にも薬にもならない．<br>That will do (   ) harm (   ) good.",
          vocab: [["do harm", "害を及ぼす"],["do good", "役に立つ"]],
          hint: ["日本語の意味：「毒にも薬にもならない」","harm も good も否定されている","2つの要素を両方打ち消す相関接続詞は？"],
          answer: "neither, nor",
          explanation: "AとBの両方を打ち消します。",
          grammar: "neither A nor B = AもBも～ない"
        },
        {
          num: "(3)",
          text: "彼女はネコ好きだという点で母親に似ている．<br>She takes after her mother (   ) (   ) she is fond of cats.",
          vocab: [["take after", "～に似ている"],["be fond of", "～が好き"]],
          hint: ["「～という点で」と限定的な理由を述べている","特定の側面での類似性を示す表現","前置詞 + that で特定の理由を示す慣用句を考えよう"],
          answer: "in that",
          explanation: "接続詞thatが導く名詞節は通常、前置詞の目的語にはなりませんが、〈in that〉などは例外です。",
          grammar: "in that = ～という点で"
        },
        {
          num: "(4)",
          text: "日本だけでなく他国もその決定を支持している．<br>Not (   ) Japan (   ) also other countries support the decision.",
          vocab: [["support", "支持する"],["decision", "決定"]],
          hint: ["日本語の「～だけでなく…も」に注目","後者（other countries）に重点がある","Not __ A __ also B の構文を考えよう"],
          answer: "only[just], but",
          explanation: "Bに重点を置いた表現なので、主語になった場合、動詞はBに一致させます。",
          grammar: "not only A but (also) B = AだけでなくBも"
        },
        {
          num: "(5)",
          text: "私たちが家に着くころには夕食ができているでしょう．<br>Dinner will be ready (   ) the (   ) we reach home.",
          vocab: [["be ready", "用意ができている"],["reach home", "家に着く"]],
          hint: ["未来の時点での完了を表す文","「～するころには」という期限の表現","前置詞 + the + 名詞 の形で時の副詞節を作る表現は？"],
          answer: "by, time",
          explanation: "時を表す副詞節なので、節中では未来のことでも現在形で表すことに注意。",
          grammar: "by the time S + V = ～するまでには"
        }
      ]
    },
    {
      title: "[3] 基本問題 3｜並べかえ (1)～(3)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "アンも仲間に入れるように，英語で話しましょう．",
          scramble: "Let's talk in English [ Ann, so, join, can, that, us ].",
          vocab: [["join", "加わる"],["talk in English", "英語で話す"]],
          hint: ["「Aが～できるように」という目的を表す構文","目的を示す接続詞 + 主語 + 助動詞の語順","日本語の「～できるように」を英語の構文に当てはめよう"],
          answer: "so that Ann can join us",
          explanation: "「Aが～できるように」〈目的〉は〈so that A can ～〉で表します。",
          grammar: "so that S + can do = Sが～できるように"
        },
        {
          num: "(2)",
          text: "私をいら立たせたのは彼の言葉ではなく，彼の態度だった．",
          scramble: "It [ but, his attitude, his words, not, that, was ] irritated me.",
          vocab: [["irritate", "いら立たせる"],["attitude", "態度"]],
          hint: ["「AではなくB」という対比","強調構文を使う","「not A but B」を強調構文に組み込む"],
          answer: "was not his words but his attitude that",
          explanation: "「AではなくてB」は〈not A but B〉で表します。強調構文と組み合わせています。",
          grammar: "It is/was not A but B that ~ = …なのはAではなくBだ"
        },
        {
          num: "(3)",
          text: "人はみな平等だという考えが頭に浮かんだ．",
          scramble: "The [ are, that, idea, occurred, all human beings, to me ] equal.",
          vocab: [["occur to", "～の頭に浮かぶ"],["human beings", "人間"],["equal", "平等な"]],
          hint: ["「～という考え」— idea の内容を説明する節がある","that節が長い場合、名詞から離して後ろに置くことがある","主語 + 動詞 + 間接目的語 + that節 の語順を考えよう"],
          answer: "idea occurred to me that all human beings are",
          explanation: "thatが導く名詞節は主語のthe ideaの内容を説明し、同格の関係になっています。",
          grammar: "The idea occurred to me that S + V = ～という考えが浮かんだ"
        }
      ]
    },
    {
      title: "[4] 基本問題 4｜英文和訳 (1)～(4)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "It is true that the doctor is over eighty, but he looks young.",
          vocab: [["It is true that", "確かに～だ"],["over eighty", "80歳を過ぎて"],["look young", "若く見える"]],
          translation: "確かにその医師は80歳を過ぎているが，若く見える．",
          explanation: "〈It is true (that) ～ but …〉は「確かに～だが，しかし…」という〈譲歩〉の意味を表します。",
          grammar: "It is true (that) ~ but ... = 確かに～だが、しかし…",
          answer: "（和訳問題）"
        },
        {
          num: "(2)",
          text: "As far as I can remember, his house is around here.",
          vocab: [["as far as", "～する限り"],["around here", "このあたり"]],
          translation: "私の覚えている限り，彼の家はこのあたりだ．",
          explanation: "〈as far as ～〉は〈範囲・程度〉を示し、「～する限り」という意味を表します。",
          grammar: "as far as S + V = Sが～する限り",
          answer: "（和訳問題）"
        },
        {
          num: "(3)",
          text: "I was so tired that I couldn't continue to work any longer.",
          vocab: [["so ... that", "とても…なので～"],["continue to work", "働き続ける"],["any longer", "もはや"]],
          translation: "私はとても疲れていたので，もはや働き続けることができなかった．",
          explanation: "〈so＋形容詞＋that ～〉の形で「とても…なので～」という〈結果〉の意味を表します。",
          grammar: "so + 形容詞 + that S + V = とても…なので～",
          answer: "（和訳問題）"
        },
        {
          num: "(4)",
          text: "Since you know how hurt she was, you should apologize to her.",
          vocab: [["since", "～なのだから"],["how hurt", "どんなに傷ついたか"],["apologize to", "～に謝る"]],
          translation: "彼女がどんなに傷ついたか君は知っているのだから，彼女に謝るべきだ．",
          explanation: "sinceは「～なのだから」と原因・理由について補足的に述べます。",
          grammar: "Since S + V, S' should ... = Sが～なのだから、S'は…すべきだ",
          answer: "（和訳問題）"
        }
      ]
    },
    {
      title: "[5] 基本問題 5｜並べかえ (1)～(5)",
      open: false,
      questions: [
        {
          num: "(1)",
          scramble: "It [ be, his cat, will, gets, not, before, long ] well.",
          text: "彼のネコはまもなく元気になるでしょう",
          vocab: [["get well", "元気になる"],["long", "長い間"]],
          hint: ["「まもなく～だろう」という近い未来を表す構文","否定 + 時間の長さ + 接続詞 の構造","時を表す副詞節では未来のことでも現在形を使う"],
          answer: "will not be long before his cat gets",
          explanation: "〈It will not be long before ～〉は「まもなく～だろう」という意味を表します。",
          grammar: "It will not be long before S + V = まもなくSが～するだろう"
        },
        {
          num: "(2)",
          scramble: "It [ not, last night, that, the girl, until, was, was ] found safe.",
          text: "昨夜になって初めてその少女が無事に発見された",
          vocab: [["last night", "昨夜"],["be found safe", "無事に発見される"]],
          hint: ["「～になって初めて」という強調表現","It was ... that の強調構文を使う","否定 + 時間表現 を強調構文に組み込む語順を考えよう"],
          answer: "was not until last night that the girl was",
          explanation: "〈It is not until...that ～〉は「…して初めて～する」という意味を表します。",
          grammar: "It is/was not until ... that S + V = …して初めてSが～する"
        },
        {
          num: "(3)",
          scramble: "He is [ he, to, wins, a champion, us, whether ] or loses the game.",
          text: "その試合に勝っても負けても彼は私たちにとってチャンピオンだ",
          vocab: [["champion", "チャンピオン"],["win/lose the game", "試合に勝つ/負ける"]],
          hint: ["「勝っても負けても」という譲歩を表す構文","「AであろうとBであろうと」を表す接続詞","主節と副詞節の構造を整理しよう"],
          answer: "a champion to us whether he wins",
          explanation: "この〈whether A or B〉は副詞節を導き、「AであろうとBであろうと」という「譲歩」の意味を表します。",
          grammar: "S + V whether A or B = AであろうとBであろうとSは～"
        },
        {
          num: "(4)",
          scramble: "It [ day, a, that, such, nice, was ] the park was full of people.",
          text: "とても天気のよい日だったので，公園は人でいっぱいだった",
          vocab: [["nice day", "良い天気の日"],["be full of", "～でいっぱいである"]],
          hint: ["結果を表す構文（「～なので」）","名詞（day）を含む場合は so ではなく別の語を使う","__ a + 形容詞 + 名詞 + 結果の接続詞 の語順"],
          answer: "was such a nice day that",
          explanation: "〈such a＋形容詞＋名詞＋that～〉で「とても…なので～」の意味を表します。",
          grammar: "such a/an + 形容詞 + 名詞 + that S + V = とても…なので～"
        },
        {
          num: "(5)",
          scramble: "I [ impossible, it, lose, that, think, this team, will ] the game.",
          text: "このチームが試合に負けることはありえないと思う",
          vocab: [["impossible", "不可能な"],["lose the game", "試合に負ける"]],
          hint: ["第5文型（SVOC）の構造を考えよう","that節が長い場合、形式目的語を使うことがある","動詞 + 形式目的語 + 補語 + that節 の語順を組み立てよう"],
          answer: "think it impossible that this team will lose",
          explanation: "〈think＋it＋C＋that ～〉で「～ということをCと思う」という意味を表します。",
          grammar: "S + think + it + C + that ~ = Sは～ということをCと思う"
        }
      ]
    },
    {
      title: "[6] FOR COMMUNICATION (1)～(3)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "A：Do you know what Miki's secret is?<br>B：Yes. I don't want to tell it to you, (   ).",
          choices: "a. although　b. though　c. but　d. for",
          vocab: [["secret", "秘密"],["tell it to you", "あなたに教える"]],
          hint: ["文末に単独で置かれている接続詞に注目","4つの選択肢のうち、文末で副詞的に使えるものは？","「でも」という譲歩を文末で表す用法を持つのはどれ？"],
          answer: "b. though",
          translation: "A「君はミキの秘密が何か知ってるの」B「うん．でも，君には教えたくないんだ」",
          explanation: "「譲歩」を表す接続詞thoughが副詞として使われ、文末に置かれることがあります。",
          grammar: "though（副詞用法）= でも、けれども（文末）",
          choiceExplanations: {
            "b. though": "○ 正解。thoughは副詞として文末に置け、「でも」という意味になる。",
            "a. although": "× althoughは文末に置くことができない。接続詞としてのみ使用。",
            "c. but": "× butは等位接続詞で、文末に単独で置くことはできない。",
            "d. for": "× forは理由を表す接続詞で、文末には置けない。"
          }
        },
        {
          num: "(2)",
          text: "A：What do you want to have as a pet?<br>B：I love dogs, (   ) my mother doesn't want to keep pets.",
          choices: "a. while　b. so　c. for　d. or",
          vocab: [["pet", "ペット"],["keep pets", "ペットを飼う"]],
          hint: ["「犬が好き」と「母は飼いたくない」— 対比関係","「～なのに、一方では～」という意味を表す接続詞は？","対比・譲歩を表す従属接続詞を選ぼう"],
          answer: "a. while",
          translation: "A「ペットとして何を飼いたいの」B「僕は犬が大好きなんだけど，お母さんはペットを飼いたくないんだよ」",
          explanation: "whileが「～なのに，一方では～」という「譲歩」の意味を表す場合があります。",
          grammar: "while = ～なのに、一方では～",
          choiceExplanations: {
            "a. while": "○ 正解。whileは「～なのに」と対比・譲歩を表すことができる。",
            "b. so": "× soは「だから」と結果を表す。前後の関係が逆になる。",
            "c. for": "× forは理由を追加する接続詞。ここでは文意に合わない。",
            "d. or": "× orは「または」で選択を表し、対比の意味にはならない。"
          }
        },
        {
          num: "(3)",
          text: "A：Jim, take an umbrella with you (   ) it rains.<br>B：All right. I will.",
          choices: "a. even if　b. if only　c. in case　d. so that",
          vocab: [["take an umbrella", "傘を持って行く"],["rain", "雨が降る"]],
          hint: ["「傘を持っていけ」→ 雨への備え","まだ起きていない事態に備える表現","「～するといけないから」という予防の意味を持つ接続詞は？"],
          answer: "c. in case",
          translation: "A「ジム，雨が降るといけないから，傘を持って行ってね」B「わかった．そうするよ」",
          explanation: "〈in case ～〉は「～するといけないから」の意味を表します。",
          grammar: "in case S + V = Sが～するといけないから",
          choiceExplanations: {
            "c. in case": "○ 正解。「～するといけないから」と備えを表す。",
            "a. even if": "× 「たとえ～でも」という仮定の譲歩で、文意に合わない。",
            "b. if only": "× 「～さえすれば」という願望を表し、意味が異なる。",
            "d. so that": "× 「～するために」という目的を表す。備えの意味にならない。"
          }
        }
      ]
    },
    {
      title: "[発展1] 語句選択 (1)～(7)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "She will not sign the contract (   ) these conditions are met.【名城大】",
          choices: "a. in place of　b. instead of　c. despite　d. unless",
          vocab: [["sign the contract", "契約書にサインする"],["conditions are met", "条件が満たされる"]],
          hint: ["否定文（will not）+ 条件の構造","「条件が満たされなければサインしない」","「もし～でないなら」を表す接続詞を選ぼう"],
          answer: "d. unless",
          translation: "これらの条件が満たされなければ，彼女は契約書にサインしないだろう",
          explanation: "unlessは「もし～でないなら」「～でない限り」の意味を表します。",
          grammar: "unless S + V = もし～でないなら",
          choiceExplanations: {
            "d. unless": "○ 正解。「～でない限り」という否定条件を表す接続詞。",
            "a. in place of": "× 「～の代わりに」という前置詞句で、接続詞ではない。",
            "b. instead of": "× 「～の代わりに」という前置詞句で、節を導けない。",
            "c. despite": "× 「～にもかかわらず」という前置詞で、節を導けない。"
          }
        },
        {
          num: "(2)",
          text: "As (   ) as I know, he has never done such a terrible thing.【関西学院大】",
          choices: "a. soon　b. long　c. far　d. much",
          vocab: [["terrible", "ひどい"],["have never done", "一度もしたことがない"]],
          hint: ["「～する限り」という範囲を表す慣用句","知識の範囲を示す表現","As __ as I know — 空所に入る語を考えよう"],
          answer: "c. far",
          translation: "私の知っている限り，彼はこのようなひどいことは決してしたことがない",
          explanation: "〈as far as ～〉は〈範囲・程度〉を示し、「～する限り」という意味を表します。",
          grammar: "as far as S + V = Sが～する限り",
          choiceExplanations: {
            "c. far": "○ 正解。as far as ～で「～する限り」と範囲を表す。",
            "a. soon": "× as soon asは「～するとすぐに」で時を表し、範囲ではない。",
            "b. long": "× as long asは「～する限り」だが、条件を表す。知識の範囲には不適切。",
            "d. much": "× as much asは「～と同じくらい」で程度を表す。"
          }
        },
        {
          num: "(3)",
          text: "Please call me the (   ) you hear anything from the hospital.【自治医大】",
          choices: "a. minute　b. month　c. season　d. year",
          vocab: [["call", "電話する"],["hear from", "～から連絡をもらう"],["hospital", "病院"]],
          hint: ["「連絡が来たらすぐに電話して」という即時性","the + 時間の名詞 が接続詞として機能する用法がある","最も短い時間単位を表す名詞はどれ？"],
          answer: "a. minute",
          translation: "病院から何かを聞いたらすぐに，私に電話してください",
          explanation: "〈the minute ～〉で「～するとすぐに」の意味を表します。",
          grammar: "the minute S + V = Sが～するとすぐに",
          choiceExplanations: {
            "a. minute": "○ 正解。the minuteは「～するとすぐに」という即時性を表す。",
            "b. month": "× the monthという接続詞的用法はない。",
            "c. season": "× the seasonという接続詞的用法はない。",
            "d. year": "× the yearという接続詞的用法はない。"
          }
        },
        {
          num: "(4)",
          text: "Don't touch my writing table; leave it (   ) it is.【中央大】",
          choices: "a. as　b. if　c. that　d. when",
          vocab: [["writing table", "書き物用テーブル"],["leave", "～のままにしておく"]],
          hint: ["「さわらないで、そのままにして」という文意","「leave + O + 状態」で「Oを～の状態のままにする」","it __ it is で「そのまま」を表す接続詞は？"],
          answer: "a. as",
          translation: "私の書き物用テーブルをさわらないで．そのままにしておいて",
          explanation: "「様態」を表す接続詞asは「～(する)ように」という意味を表します。",
          grammar: "as S + V = Sが～するように / as it is = そのまま",
          choiceExplanations: {
            "a. as": "○ 正解。as it isで「そのまま」という様態を表すイディオム。",
            "b. if": "× if it isは条件を表し、「そのまま」の意味にならない。",
            "c. that": "× that it isという用法はこの文脈では不適切。",
            "d. when": "× when it isは時を表し、様態の意味にならない。"
          }
        },
        {
          num: "(5)",
          text: "(   ) our teacher is ill, we shall have to study by ourselves.【成城大】",
          choices: "a. Even if　b. Though　c. Now that　d. However",
          vocab: [["be ill", "病気である"],["study by ourselves", "自習する"]],
          hint: ["「先生が病気」は既知の事実として述べられている","既知の事実に基づく理由を述べる接続詞","「今や～なのだから」という現状を理由にする表現は？"],
          answer: "c. Now that",
          translation: "先生が病気なのだから，私たちは自習しなければならないだろう",
          explanation: "〈now (that) ～〉は「(今やもう)～なので」の意味を表します。",
          grammar: "now (that) S + V = ～なので",
          choiceExplanations: {
            "c. Now that": "○ 正解。「～なのだから」と既知の事実に基づく理由を表す。",
            "a. Even if": "× 「たとえ～でも」と仮定の譲歩で、理由にならない。",
            "b. Though": "× 「～だけれども」と譲歩で、因果関係を表さない。",
            "d. However": "× 副詞で「しかしながら」。接続詞として節を導けない。"
          }
        },
        {
          num: "(6)",
          text: "It won't be long (   ) we see each other again.【広島工業大】",
          choices: "a. before　b. after　c. when　d. soon",
          vocab: [["see each other", "お互いに会う"],["won't be long", "長くはかからない"]],
          hint: ["「まもなく～だろう」という近い未来の表現","It won't be long __ の空所に入る接続詞","「長くはかからないうちに」→ 時を表す接続詞を選ぼう"],
          answer: "a. before",
          translation: "私たちはまもなくまたお互いに会うでしょう",
          explanation: "〈It won't be long before ～〉は「まもなく～だろう」という意味を表します。",
          grammar: "It won't be long before S + V = まもなくSが～するだろう",
          choiceExplanations: {
            "a. before": "○ 正解。It won't be long beforeで「まもなく～」のイディオム。",
            "b. after": "× It won't be long afterという表現は使わない。",
            "c. when": "× It won't be long whenという表現は使わない。",
            "d. soon": "× soonは副詞で、ここでは接続詞が必要。"
          }
        },
        {
          num: "(7)",
          text: "I had hardly gone out of the house (   ) I heard a telephone ringing.【名城大】",
          choices: "a. if　b. since　c. than　d. when",
          vocab: [["go out of", "～から出る"],["hear ... ringing", "～が鳴るのが聞こえる"]],
          hint: ["「hardly」という否定の副詞に注目","2つの動作がほぼ同時に起きている","hardly ... __ で「～するかしないうちに」を表す組み合わせは？"],
          answer: "d. when",
          translation: "私が家から出たとたんに，電話が鳴るのが聞こえた",
          explanation: "〈hardly…when ～〉で「…するかしないうちに～」という意味を表します。",
          grammar: "S + had hardly + 過去分詞 + when + 過去形 = ～するとすぐに…した",
          choiceExplanations: {
            "d. when": "○ 正解。hardly...whenで「～するかしないうちに」のイディオム。",
            "a. if": "× hardly...ifという表現はない。",
            "b. since": "× hardly...sinceという表現はない。",
            "c. than": "× no sooner...thanと混同しないこと。hardlyにはwhenを使う。"
          }
        }
      ]
    },
    {
      title: "[発展2] 誤り訂正 (1)～(3)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "John is <u>a. so</u> a good hairdresser <u>b. that</u> I always <u>c. have</u> my hair <u>d. cut</u> at his salon.【東京理科大】",
          vocab: [["hairdresser", "美容師"],["have my hair cut", "髪を切ってもらう"],["salon", "美容室"]],
          hint: ["下線部のどれかが文法的に誤り","名詞（a good hairdresser）を修飾する語に注目","「とても～なので」を名詞ありで表す場合、soの代わりに何を使う？"],
          answer: "a. so → such",
          translation: "ジョンは非常に上手な美容師なので私はいつも彼の美容室で髪を切ってもらう",
          explanation: "名詞がある場合は〈such a＋形容詞＋名詞＋that ～〉を使います。",
          grammar: "such a/an + 形容詞 + 名詞 + that S + V"
        },
        {
          num: "(2)",
          text: "I'll <u>a. draw</u> a map <u>b. for</u> you <u>c. at case</u> you can't <u>d. find</u> our house.【札幌学院大】",
          vocab: [["draw a map", "地図を描く"],["find", "見つける"]],
          hint: ["下線部のどれかが前置詞の誤り","「～するといけないから」という備えの表現","c の前置詞が正しいかチェックしよう"],
          answer: "c. at case → in case",
          translation: "私たちの家が見つからないといけないから，地図を描いてあげましょう",
          explanation: "〈in case S＋V ～〉で「Sが～するといけないから」の意味を表します。",
          grammar: "in case S + V = Sが～するといけないから"
        },
        {
          num: "(3)",
          text: "<u>a. Though</u> he was tired after working <u>b. hard</u>, <u>c. but</u> he went to the <u>d. movies</u> with his friends.【東京薬科大】",
          vocab: [["tired", "疲れた"],["work hard", "一生懸命働く"],["go to the movies", "映画を見に行く"]],
          hint: ["従属接続詞と等位接続詞の関係に注目","a と c、両方とも逆接の接続詞が使われている","1つの文に同じ意味の接続詞を2つ使えるか考えよう"],
          answer: "c. but → 削除（heに変更）",
          translation: "彼は一生懸命働いた後で疲れていたけれども，友人たちと映画を見に行った",
          explanation: "thoughとbutを同時に使うことはできません。",
          grammar: "though と but は同時に使えない"
        }
      ]
    },
    {
      title: "[発展3] 英作文 (1)～(2)",
      open: false,
      questions: [
        {
          num: "(1)",
          text: "困ったことに私は十分なお金を持っていません．【愛知工業大】<br>The trouble ___.",
          vocab: [["trouble", "困ったこと"],["enough money", "十分なお金"]],
          hint: ["「困ったことに～だ」という表現","The trouble で始まる文を完成させる","名詞 + be動詞 + 接続詞 + 節 の構文を考えよう"],
          answer: "is (that) I don't have enough money",
          explanation: "「困ったことに～だ」は〈The trouble is (that) ～〉で表現できます。",
          grammar: "The trouble is (that) S + V = 困ったことにSが～だ"
        },
        {
          num: "(2)",
          text: "私はこの音楽を聞くたびに，癒される気がする．",
          vocab: [["hear this music", "この音楽を聞く"],["feel comforted", "癒される気がする"]],
          hint: ["「～するたびに」という繰り返しの表現","時を表す副詞節を導く接続詞的表現","「～するたびに」を表す複数の言い方を考えよう"],
          answer: "Every[Each] time I hear this music, I feel comforted. / Whenever I hear this music, I feel comforted.",
          explanation: "〈every [each] time ～〉は「～するたびに」という意味を表します。",
          grammar: "every/each time S + V = Sが～するたびに"
        }
      ]
    }
  ]
};

// ===== NAVIGATION STATE =====
const NavState = {
  view: 'home',        // 'home' | 'overview' | 'question'
  category: 'basic',   // 'basic' | 'comm' | 'advanced'
  section: 0,          // 0-8 section index
  categoryMap: {
    basic: [0, 1, 2, 3, 4],    // 5 sections
    comm: [5],                  // 1 section
    advanced: [6, 7, 8]         // 3 sections
  }
};

// Category display info
const categoryInfo = {
  basic: { name: '基本問題', icon: '&#128218;', class: 'basic' },
  comm: { name: 'For Communication', icon: '&#128172;', class: 'comm' },
  advanced: { name: '発展問題', icon: '&#128640;', class: 'advanced' }
};

// ===== ROUTER =====
const Router = {
  navigate(view, category = null, section = null) {
    NavState.view = view;

    if (view === 'question') {
      if (category) NavState.category = category;
      if (section !== null) {
        NavState.section = section;
      } else {
        // Default to first section of category
        NavState.section = NavState.categoryMap[NavState.category][0];
      }
    }

    this.updateHash();
    this.render();
  },

  setCategory(category) {
    NavState.category = category;
    NavState.section = NavState.categoryMap[category][0];
    this.updateHash();
    this.render();
  },

  setSection(section) {
    NavState.section = section;
    this.updateHash();
    this.render();
  },

  updateHash() {
    let hash = '#' + NavState.view;
    if (NavState.view === 'question') {
      const localIndex = NavState.categoryMap[NavState.category].indexOf(NavState.section);
      hash += '/' + NavState.category + '/' + (localIndex + 1);
    }
    history.pushState(null, '', hash);
  },

  parseHash() {
    const hash = window.location.hash.slice(1) || 'home';
    const parts = hash.split('/');

    NavState.view = parts[0] || 'home';

    if (NavState.view === 'question' && parts.length >= 3) {
      NavState.category = parts[1] || 'basic';
      const localIndex = parseInt(parts[2], 10) - 1 || 0;
      const sections = NavState.categoryMap[NavState.category] || [0];
      NavState.section = sections[Math.min(localIndex, sections.length - 1)] || 0;
    }
  },

  render() {
    // Update main nav
    document.querySelectorAll('.top-nav-link').forEach(link => {
      link.classList.toggle('active', link.dataset.nav === NavState.view);
    });
    document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.nav === NavState.view);
    });

    // Update views
    document.querySelectorAll('.view-home, .view-overview, .view-question').forEach(view => {
      view.classList.remove('active');
    });

    const mainContent = document.getElementById('mainContent');
    const subNav = document.getElementById('subNav');

    if (NavState.view === 'home') {
      document.getElementById('viewHome').classList.add('active');
      subNav.classList.remove('visible');
      mainContent.classList.remove('has-subnav');
    } else if (NavState.view === 'overview') {
      document.getElementById('viewOverview').classList.add('active');
      subNav.classList.remove('visible');
      mainContent.classList.remove('has-subnav');
      // Initialize tilt effect for overview cards
      // Overview カードの傾きエフェクトを初期化
      setTimeout(initTypeCardTilt, 100);
    } else if (NavState.view === 'question') {
      document.getElementById('viewQuestion').classList.add('active');
      // Only show sub-nav if nav is visible (respects auto-hide state)
      // ナビが表示中の場合のみサブナビを表示（自動非表示状態を尊重）
      if (navVisible) {
        subNav.classList.add('visible');
      }
      mainContent.classList.add('has-subnav');
      this.renderQuestionView();
    }

    // Invalidate caches when switching views
    invalidateCaches();
  },

  renderQuestionView() {
    // Update sub-nav categories
    document.querySelectorAll('.sub-nav-cat').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.cat === NavState.category);
    });

    // Render section toggles
    const sections = NavState.categoryMap[NavState.category];
    const togglesContainer = document.getElementById('sectionToggles');
    togglesContainer.innerHTML = sections.map((sectionIndex, i) => {
      const isActive = NavState.section === sectionIndex;
      return `<button class="sub-nav-section ${isActive ? 'active' : ''}"
                      onclick="Router.setSection(${sectionIndex})">${i + 1}</button>`;
    }).join('');

    // Update header
    const info = categoryInfo[NavState.category];
    const badge = document.getElementById('categoryBadge');
    badge.className = 'question-category-badge ' + info.class;
    document.getElementById('categoryIcon').innerHTML = info.icon;
    document.getElementById('categoryName').textContent = info.name;

    const sectionData = grammarData.sections[NavState.section];
    document.getElementById('sectionTitle').textContent = sectionData.title;
    document.getElementById('sectionSubtitle').textContent =
      sectionData.questions.length + ' questions';

    // Render questions
    renderQuestions(NavState.section);

    // Initialize card reveal animations
    initCardReveal();

    // Reset search
    const searchInput = document.getElementById('searchInput');
    if (searchInput) searchInput.value = '';

    // Update progress
    updateProgress();
  }
};

// ===== RENDER FUNCTIONS =====
function renderQuestion(q) {
  let questionHtml = `<div class="qcard-question">
    <span class="qnum">${q.num}</span>
    <div class="qtext">${q.text}</div>`;
  if (q.choices) questionHtml += `<div class="choices">${q.choices}</div>`;
  if (q.scramble) questionHtml += `<div class="scramble">${q.scramble}</div>`;
  questionHtml += `</div>`;

  let btnHtml = `<div class="qcard-buttons">
    <button class="toggle-btn vocab" onclick="toggle(this,'vocab')">Words</button>`;
  if (q.hint) btnHtml += `<button class="toggle-btn hint" onclick="toggle(this,'hint')">Hint</button>`;
  btnHtml += `<button class="toggle-btn answer" onclick="toggle(this,'answer')">Answer</button></div>`;

  let leftHtml = `<div class="qcard-left">
    <div class="toggle-btn-row">
      <button class="toggle-btn vocab" onclick="toggle(this,'vocab')">Words</button>`;
  if (q.hint) leftHtml += `<button class="toggle-btn hint" onclick="toggle(this,'hint')">Hint</button>`;
  leftHtml += `</div>`;
  if (q.vocab) {
    leftHtml += `<div class="collapsible" data-type="vocab"><div class="box vocab-box">`;
    q.vocab.forEach(v => leftHtml += `<div class="vocab-item"><span class="vocab-word">${v[0]}</span>${v[1]}</div>`);
    leftHtml += `</div></div>`;
  }
  if (q.hint) {
    leftHtml += `<div class="collapsible" data-type="hint"><div class="box hint-box"><span class="box-label">Solution</span>`;
    q.hint.forEach(h => leftHtml += `<div class="hint-item">&#8594; ${h}</div>`);
    leftHtml += `</div></div>`;
  }
  leftHtml += `</div>`;

  let rightHtml = `<div class="qcard-right">
    <div class="toggle-btn-row">
      <button class="toggle-btn answer" onclick="toggle(this,'answer')">Answer</button>
    </div>
    <div class="collapsible" data-type="answer"><div class="box ans-box">
      <span class="box-label">&#27491;&#35299;: ${q.answer}</span>`;
  if (q.translation) rightHtml += `<div class="jp-text">${q.translation}</div>`;
  if (q.explanation) rightHtml += `<div class="jp-text">${q.explanation}</div>`;
  if (q.choiceExplanations) {
    rightHtml += `<div class="choice-explanations">`;
    for (const [choice, exp] of Object.entries(q.choiceExplanations)) {
      const isCorrect = q.answer.includes(choice);
      rightHtml += `<div class="choice-exp ${isCorrect ? 'correct' : 'wrong'}">${exp}</div>`;
    }
    rightHtml += `</div>`;
  }
  if (q.grammar) rightHtml += `<div class="grammar-ref">${q.grammar}</div>`;
  rightHtml += `</div></div></div>`;

  return `<div class="qcard">${questionHtml}${btnHtml}${leftHtml}${rightHtml}</div>`;
}

function renderQuestions(sectionIndex) {
  const section = grammarData.sections[sectionIndex];
  const container = document.getElementById('questionsList');
  container.innerHTML = section.questions.map(q => renderQuestion(q)).join('');
}

// ===== CARD REVEAL ANIMATION =====
// IntersectionObserver for smooth card reveal on scroll
let revealObserver = null;

function initCardReveal() {
  // Disconnect previous observer if exists
  if (revealObserver) {
    revealObserver.disconnect();
  }

  // Check for reduced motion preference
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    // Skip animation for reduced motion - just make all cards visible
    document.querySelectorAll('.qcard').forEach(card => {
      card.classList.add('visible');
    });
    return;
  }

  const observerOptions = {
    root: null,
    rootMargin: '50px',
    threshold: 0.1
  };

  revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        revealObserver.unobserve(entry.target);
      }
    });
  }, observerOptions);

  // Observe all question cards
  document.querySelectorAll('.qcard').forEach(card => {
    revealObserver.observe(card);
  });
}

// ===== EVENT HANDLERS =====
function toggle(btn, type) {
  const card = btn.closest('.qcard');
  const block = card.querySelector(`.collapsible[data-type="${type}"]`);
  if (block) {
    block.classList.toggle('open');
    updateProgress();
  }
}

function setView(view) {
  document.body.setAttribute('data-view', view);
  try { localStorage.setItem('viewMode', view); } catch(e) {}
  document.querySelectorAll('.view-btn-nav').forEach(btn => {
    btn.classList.toggle('active', btn.getAttribute('data-view') === view);
  });
}

// ===== PROGRESS =====
let progressBarEl = null;
let progressTextEl = null;

function updateProgress() {
  if (!progressBarEl) progressBarEl = document.getElementById('progressBar');
  if (!progressTextEl) progressTextEl = document.getElementById('progressText');

  const total = document.querySelectorAll('.collapsible[data-type="answer"]').length;
  const revealed = document.querySelectorAll('.collapsible[data-type="answer"].open').length;
  const pct = total > 0 ? Math.round((revealed / total) * 100) : 0;

  if (progressBarEl) progressBarEl.style.width = pct + '%';
  if (progressTextEl) progressTextEl.textContent = `${revealed} / ${total} answers revealed`;
}

// ===== SEARCH =====
let searchTimeout = null;
let searchIndex = null;

function invalidateCaches() {
  searchIndex = null;
  progressBarEl = null;
  progressTextEl = null;
}

function buildSearchIndex() {
  const section = grammarData.sections[NavState.section];
  searchIndex = section.questions.map((q, qi) => ({
    questionIndex: qi,
    searchText: [
      q.text || '',
      q.choices || '',
      q.scramble || '',
      q.answer || '',
      q.translation || '',
      q.grammar || '',
      (q.vocab || []).flat().join(' '),
      (q.hint || []).join(' ')
    ].join(' ').toLowerCase()
  }));
}

function debouncedSearch() {
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(handleSearch, 150);
}

function handleSearch() {
  const searchInput = document.getElementById('searchInput');
  if (!searchIndex) buildSearchIndex();

  const query = searchInput.value.toLowerCase().trim();
  const cards = document.querySelectorAll('.qcard');

  if (!query) {
    cards.forEach(card => card.classList.remove('no-match'));
    return;
  }

  searchIndex.forEach((q, qi) => {
    const card = cards[qi];
    if (!card) return;
    card.classList.toggle('no-match', !q.searchText.includes(query));
  });
}

// ===== THEME =====
function toggleTheme() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
  try { localStorage.setItem('theme', isDark ? 'light' : 'dark'); } catch(e) {}
  document.querySelector('.theme-icon').innerHTML = isDark ? '&#9728;&#65039;' : '&#127769;';
}

// ===== TILT EFFECT FOR OVERVIEW CARDS =====
// 3D傾きエフェクト - Overview カードにインタラクティブな動きを追加
function initTypeCardTilt() {
  const cards = document.querySelectorAll('.conj-card');
  if (!cards.length) return;

  cards.forEach(card => {
    let rafId = null;
    let targetX = 0, targetY = 0;
    let currentX = 0, currentY = 0;

    card.addEventListener('mouseenter', () => {
      card.style.transition = 'box-shadow 0.3s ease';
    });

    card.addEventListener('mousemove', (e) => {
      const rect = card.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      targetX = (y - centerY) / 80;
      targetY = (centerX - x) / 80;

      if (!rafId) {
        rafId = requestAnimationFrame(() => {
          currentX += (targetX - currentX) * 0.15;
          currentY += (targetY - currentY) * 0.15;
          card.style.transform = `perspective(1000px) rotateX(${currentX}deg) rotateY(${currentY}deg) translateY(-3px)`;
          card.style.boxShadow = 'var(--shadow-lg)';
          rafId = null;
        });
      }
    });

    card.addEventListener('mouseleave', () => {
      if (rafId) cancelAnimationFrame(rafId);
      rafId = null;
      card.style.transition = 'transform 0.4s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.3s ease';
      card.style.transform = '';
      card.style.boxShadow = '';
      currentX = 0;
      currentY = 0;
      targetX = 0;
      targetY = 0;
    });
  });
}

// ===== AUTO-HIDE NAVIGATION =====
// ナビゲーション自動非表示機能
let navVisible = true;        // Start visible - 最初は表示
let hideTimeout = null;
let hasScrolled = false;      // Track if user has scrolled - スクロール検出用

function showNav() {
  clearTimeout(hideTimeout);
  navVisible = true;
  document.querySelector('.top-nav').classList.add('visible');
  // Sub-nav only shows if in question view
  if (NavState.view === 'question') {
    document.getElementById('subNav').classList.add('visible');
  }
}

function hideNav() {
  hideTimeout = setTimeout(() => {
    navVisible = false;
    document.querySelector('.top-nav').classList.remove('visible');
    document.getElementById('subNav').classList.remove('visible');
  }, 300); // Small delay to prevent flickering
}

function initAutoHideNav() {
  const topNav = document.querySelector('.top-nav');
  const subNav = document.getElementById('subNav');

  // Show nav on page load - ページ読み込み時に表示
  showNav();

  // First scroll detection - hide nav after first scroll
  // 最初のスクロールでナビを隠す
  window.addEventListener('scroll', () => {
    if (!hasScrolled && window.scrollY > 50) {
      hasScrolled = true;
      hideNav();
    }
  }, { passive: true });

  // PC: Mouse hover detection (only after first scroll)
  // PC: マウスホバー検出（スクロール後のみ）
  document.addEventListener('mousemove', (e) => {
    if (!hasScrolled) return; // Don't hide until user has scrolled
    if (e.clientY < 80) {
      showNav();
    } else if (e.clientY > 200 && navVisible) {
      hideNav();
    }
  });

  // Prevent hiding when hovering over nav itself
  // ナビにホバー中は隠さない
  topNav.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
  subNav.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
  topNav.addEventListener('mouseleave', () => {
    if (hasScrolled) hideNav();
  });
  subNav.addEventListener('mouseleave', () => {
    if (hasScrolled) hideNav();
  });

  // iPad/Touch: Tap detection at top
  // iPad/タッチ: 画面上部タップで表示/非表示
  document.addEventListener('touchstart', (e) => {
    const touch = e.touches[0];
    if (touch.clientY < 100) {
      if (navVisible && hasScrolled) {
        hideNav();
      } else {
        showNav();
      }
    } else if (touch.clientY > 200 && navVisible && hasScrolled) {
      // Tap elsewhere hides nav (only after first scroll)
      hideNav();
    }
  }, { passive: true });
}

// ===== INIT =====
window.addEventListener('DOMContentLoaded', () => {
  // Load saved preferences
  try {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
      document.documentElement.setAttribute('data-theme', 'dark');
      document.querySelector('.theme-icon').innerHTML = '&#127769;';
    }
    const savedView = localStorage.getItem('viewMode') || 'single';
    setView(savedView);
  } catch(e) {}

  // Parse initial hash and render
  Router.parseHash();
  Router.render();

  // Initialize auto-hide navigation
  // ナビゲーション自動非表示を初期化
  initAutoHideNav();
});

// Handle browser back/forward
window.addEventListener('popstate', () => {
  Router.parseHash();
  Router.render();
});
</script>
<link rel="stylesheet" href="../../../teacher-reveal.css">
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database-compat.js"></script>
<script src="../../../firebase-config.js"></script>
<script src="../../../teacher-reveal.js"></script>
</body>
</html>
