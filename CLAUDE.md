# English Resources - Claude Code Guidelines

## Project Overview

Static site hosting English learning materials for Japanese high school students.
Deployed on GitHub Pages at `harashima-eng.github.io/English-Resources`.

- **Languages**: HTML, CSS, JavaScript (vanilla, no framework)
- **Content**: Grammar lessons, conversation practice, university entrance exam past papers
- **Audience**: Japanese high school students (grades 1-3) and their teachers

## Architecture

```
File change detected by fswatch
  -> english-resources-generate.py (regenerates all index.html + sitemap.xml)
  -> english-resources-autosync.sh (git add -> commit -> push)
  -> GitHub Pages publishes (1-5 min)
```

### Key Locations
| What | Path |
|------|------|
| Repo | `/Users/slimtetto/Projects/English-Resources` |
| Generator + modules | `/usr/local/bin/english-resources-generate.py` + `/usr/local/bin/english_resources/` |
| Auto-sync | `/usr/local/bin/english-resources-autosync.sh` |
| Backup | `/usr/local/bin/english-resources-backup.sh` |
| LaunchAgents | `~/Library/LaunchAgents/com.english-resources.*.plist` |
| Scripts backup | `.scripts/` directory in repo (version-controlled copies) |

### Generated Files (do NOT edit manually)
- All `index.html` files (regenerated by generator)
- `styles.css` (generated from `templates.py`)
- `sitemap.xml` (generated from repo scan)
- `data.json` (settings only, updated when settings change)

### Single Source of Truth
- **Colors**: `GRADE_COLORS` dict in `/usr/local/bin/english_resources/colors.py`
- **CSS**: `MAIN_STYLE` string in `/usr/local/bin/english_resources/templates.py`
- **Settings**: `data.json` in repo root

## Content Files

Content HTML files (lessons, exams) are manually authored. They are standalone single-file apps with inline `<style>` and `<script>`.

### Adding Content
1. Put HTML file in the right folder (e.g., `高校２年/論理・表現II/Dual Scope/`)
2. Auto-sync handles the rest (regenerates indexes, commits, pushes)

## CSS & Performance Notes

### transition: all - OK to use
`transition: all` is used throughout this project and works fine on the target machine (MacBook Pro 16", i9, Radeon Pro 5500M). The elements being transitioned are simple (cards, buttons, arrows) with few animatable properties, so `transition: all` has negligible performance impact here. No need to replace with specific properties.

### backdrop-filter - OK to use
`backdrop-filter` is used for nav bars and glass morphism effects. Single instances per page are fine. The only crash risk would be mass stacked `backdrop-filter` (many overlapping blurred elements), which this project doesn't do. Current usage is safe.

### GPU Rasterization
GPU rasterization is OFF (user preference). This only affects paint-to-bitmap. All compositing, WebGL, Canvas, video remain GPU-accelerated.

## Color System (Nordic Palette)

| Grade | Name | Primary | Dark |
|-------|------|---------|------|
| 高校１年 | Nordic rust | `#A05020` | `#8A4018` |
| 高校２年 | Nordic fjord teal | `#7A9BA8` | `#6A8B98` |
| 高校３年 | Nordic forest | `#337058` | `#2A5F4A` |

All colored icons use **inline styles** from GRADE_COLORS, NOT CSS classes.

## Rules

- Do NOT edit generated files directly (index.html, styles.css, sitemap.xml)
- Edit the generator scripts if you need to change the UI
- Content files are independent - edit them freely
- `.DS_Store` files are gitignored and must not be committed
- Auto-sync script handles git operations automatically
- After editing scripts in `/usr/local/bin/`, also update copies in `.scripts/`

## DUAL SCOPE Content Rules

These apply to all lesson files in `高校２年/論理・表現II/Dual Scope/`.

### The Golden Rule
**Keep original question text exactly as the PDF source.** Never invent, rephrase, or reorganize questions. The textbook is the single source of truth.

### Section Structure
Sections must match the PDF ordering and numbering exactly. Never merge, split, reorder, or omit sections.

### Vocab (Words button)
Teach **non-answer** vocabulary in the sentence. Never include the answer word/phrase as a vocab entry.

### Hints (Hint button)
3 progressive thinking prompts that guide toward the grammar concept. **Never state the answer.**

### Answer Section (Answer button)
Write freely — this is hidden behind the Answer button. Include answer, translation, explanation, grammar pattern, and per-choice breakdowns where applicable.
